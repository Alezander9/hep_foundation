============================= test session starts ==============================
platform linux -- Python 3.9.21, pytest-8.3.5, pluggy-1.5.0 -- /sdf/home/a/alexyue/miniconda3/envs/hep_foundation/bin/python3
cachedir: .pytest_cache
rootdir: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation
configfile: pytest.ini
plugins: cov-6.1.1
collecting ... collected 1 item

tests/test_pipeline.py::test_run_full_pipeline
-------------------------------- live log setup --------------------------------
2025-06-27 16:03:44 [    INFO] Foundation Model Pipeline initialized. (foundation_model_pipeline.py:69)
2025-06-27 16:03:44 [    INFO]   Experiment outputs will be in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments (foundation_model_pipeline.py:70)
2025-06-27 16:03:44 [    INFO]   Processed datasets will be in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets (foundation_model_pipeline.py:73)
2025-06-27 16:03:44 [    INFO] TensorFlow: 2.13.1 (Eager: True) (foundation_model_pipeline.py:76)
2025-06-27 16:03:44 [    INFO] Loading configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/tests/_test_pipeline_config.yaml (config_loader.py:60)
2025-06-27 16:03:44 [    INFO] Creating configuration objects... (config_loader.py:118)
2025-06-27 16:03:44 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.eta' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 16:03:44 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.pt' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 16:03:44 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
-------------------------------- live log call ---------------------------------
2025-06-27 16:03:44 [    INFO] Starting full pipeline test (test_pipeline.py:111)
2025-06-27 16:03:44 [    INFO] Loading configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/tests/_test_pipeline_config.yaml (config_loader.py:60)
2025-06-27 16:03:44 [    INFO] Creating configuration objects... (config_loader.py:118)
2025-06-27 16:03:44 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.eta' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 16:03:44 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.pt' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 16:03:44 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 16:03:44 [    INFO] Source config file set to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/tests/_test_pipeline_config.yaml (foundation_model_pipeline.py:88)
2025-06-27 16:03:44 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:219)
2025-06-27 16:03:44 [    INFO] RUNNING FULL FOUNDATION MODEL PIPELINE (foundation_model_pipeline.py:220)
2025-06-27 16:03:44 [    INFO] Process: Train → Regression → Signal Classification → Anomaly Detection (foundation_model_pipeline.py:221)
2025-06-27 16:03:44 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:224)
2025-06-27 16:03:44 [    INFO]
================================================== (foundation_model_pipeline.py:228)
2025-06-27 16:03:44 [    INFO] STEP 1/4: TRAINING FOUNDATION MODEL (foundation_model_pipeline.py:229)
2025-06-27 16:03:44 [    INFO] ================================================== (foundation_model_pipeline.py:230)
2025-06-27 16:03:44 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:348)
2025-06-27 16:03:44 [    INFO] Training Foundation Model (foundation_model_pipeline.py:349)
2025-06-27 16:03:44 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:350)
2025-06-27 16:03:44 [    INFO] Signal keys to process: ['zprime_tt', 'zprime_bb'] (foundation_model_pipeline.py:355)
2025-06-27 16:03:44 [    INFO] ModelRegistry paths: (model_registry.py:27)
2025-06-27 16:03:44 [    INFO] Base path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments (model_registry.py:28)
2025-06-27 16:03:44 [    INFO] DB path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (model_registry.py:29)
2025-06-27 16:03:44 [    INFO] Registry initialized at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (foundation_model_pipeline.py:380)
2025-06-27 16:03:44 [    INFO] Initializing managers... (foundation_model_pipeline.py:383)
2025-06-27 16:03:44 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 16:03:44 [    INFO] Validated dataset config (foundation_model_pipeline.py:388)
2025-06-27 16:03:44 [    INFO] Validated training config (foundation_model_pipeline.py:391)
2025-06-27 16:03:44 [    INFO] Loading datasets... (foundation_model_pipeline.py:394)
2025-06-27 16:03:44 [    INFO] Loading ATLAS datasets... (foundation_model_pipeline.py:397)
2025-06-27 16:03:44 [    INFO] Loading datasets (dataset_manager.py:802)
2025-06-27 16:03:44 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:03:44 [    INFO] Creating new dataset (dataset_manager.py:250)
2025-06-27 16:03:44 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:03:44 [    INFO] Processing run 00298967 (dataset_manager.py:283)
2025-06-27 16:03:44 [    INFO] Processing ATLAS data for run 00298967 (physlite_feature_processor.py:1003)
2025-06-27 16:03:44 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 16:03:44 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 16:03:44 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 16:03:44 [    INFO] [debug] Initially required branches (incl. derived): {'InDetTrackParticlesAuxDyn.z0', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'MET_Core_AnalysisMETAuxDyn.mpy', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.pt', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1033)
2025-06-27 16:03:44 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1061)
2025-06-27 16:03:44 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF'} (physlite_feature_processor.py:1064)
2025-06-27 16:03:44 [    INFO] Actual branches to read from file: {'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.numberDoF', 'MET_Core_AnalysisMETAuxDyn.mpy', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.d0', 'InDetTrackParticlesAuxDyn.chiSquared', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1067)
2025-06-27 16:03:44 [    INFO] Getting catalog paths for run 00298967 and signal None (physlite_feature_processor.py:1079)
2025-06-27 16:03:44 [    INFO] Found 2 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 16:03:44 [    INFO] Plotting enabled. Aiming for ~2500 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 16:03:44 [    INFO] Processing catalog 1/2 with path: atlas_data/catalogs/Run_00298967_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 16:03:46 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'InDetTrackParticlesAuxDyn.z0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpy': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([0., 0.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 16:03:46 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'InDetTrackParticlesAuxDyn.z0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpy': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([0., 0.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 16:03:46 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'InDetTrackParticlesAuxDyn.z0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpy': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([0., 0.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 16:03:46 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'InDetTrackParticlesAuxDyn.z0': array([-16.916328, -32.308327,  58.49811 , -32.18765 , -32.10135 ,
       -32.05595 , -32.095116, -31.947983,  10.947017], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([15., 51., 54., 38., 42., 35., 43., 26., 31.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpy': array([2917.072, 9026.598], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([-6.6143926e-05, -1.0783443e-04, -2.5288420e-04,  2.0579198e-04,
       -1.3872961e-04,  8.7678985e-05, -1.2646682e-04, -2.1160622e-04,
       -2.2116047e-04], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([2.9713178 , 2.5829854 , 1.0149598 , 0.6786004 , 2.4676406 ,
       0.7737514 , 2.614008  , 0.85339445, 2.44664   ], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([ 0.13263644, -0.02171086,  0.00573416, -0.04170312, -0.03904025,
       -0.02388315, -0.00572811, -0.0045231 , -0.01548618], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([18.002485, 43.043682, 49.211033, 30.54344 , 43.093258, 39.571404,
       34.672108, 39.55346 , 26.473286], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([3950.3628, 3931.1497], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([226113.88 ,  53718.094], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([-0.7860747 , -2.1698403 ,  0.62683016, -1.770601  , -2.2839856 ,
       -1.7957953 , -2.2082472 ,  0.96130866,  0.19878747], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 16:03:47 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'InDetTrackParticlesAuxDyn.z0': array([-55.209663, -55.129837, -55.110397, -54.956932, -55.164303,
       -55.039574, -55.226418, -55.239536, -55.117817, -55.1299  ,
       -55.064724, -55.08418 , -54.853413, -55.25521 ], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([21., 19., 26., 15., 38., 42., 43., 50., 22., 43., 41., 40., 10.,
       33.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpy': array([ 4944.2974, -2786.3242], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([ 7.3403731e-05,  3.1320455e-05, -1.2891174e-04, -9.1019674e-06,
        1.0585919e-04,  6.7659093e-05, -1.6294660e-04, -2.0465015e-04,
       -1.2586276e-04, -4.0642024e-04, -1.9996920e-04,  2.7437514e-04,
        2.8197269e-04, -1.7973114e-04], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([0.20400521, 0.20323035, 0.25270194, 0.21027593, 1.2624797 ,
       1.3421053 , 1.301371  , 1.371753  , 0.6967735 , 1.1996694 ,
       0.62363476, 0.56082845, 1.2570741 , 1.5608509 ], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([-0.05088669,  0.29357564, -0.03500424, -0.01277314, -0.02793986,
       -0.03660518,  0.00095294,  0.00965733, -0.01739617,  0.03437834,
        0.0255817 , -0.04874401,  0.0080739 , -0.12628022], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([27.949524 , 17.56657  , 48.63797  ,  6.8980656, 20.873167 ,
       33.23165  , 33.20409  , 47.705704 , 12.156644 , 36.02148  ,
       26.540726 , 33.875515 , 24.180946 , 45.991604 ], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([ 5210.8325, -3313.4116], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([132987.1  ,  30587.148], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([-0.14381175, -0.16379137, -0.09652591, -0.05987956,  3.0106819 ,
        3.0062318 ,  3.0235908 ,  3.033448  , -1.8334734 ,  2.987984  ,
       -1.9293301 , -1.987573  ,  2.7328026 ,  0.3753599 ], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 16:04:01 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 16:04:01 [    INFO]   Total events read: 57629 (physlite_feature_processor.py:1404)
2025-06-27 16:04:01 [    INFO]   Events passing selection (incl. derived calc): 17630 (physlite_feature_processor.py:1405)
2025-06-27 16:04:01 [    INFO]   Processing time: 16.57s (physlite_feature_processor.py:1408)
2025-06-27 16:04:01 [    INFO]   Rate: 3477.5 events/s (physlite_feature_processor.py:1409)
2025-06-27 16:04:01 [    INFO] Processing catalog 2/2 with path: atlas_data/catalogs/Run_00298967_catalog_1.root (physlite_feature_processor.py:1120)
2025-06-27 16:04:16 [    INFO] Catalog 1 summary: (physlite_feature_processor.py:1403)
2025-06-27 16:04:16 [    INFO]   Total events read: 55732 (physlite_feature_processor.py:1404)
2025-06-27 16:04:16 [    INFO]   Events passing selection (incl. derived calc): 14477 (physlite_feature_processor.py:1405)
2025-06-27 16:04:16 [    INFO]   Processing time: 15.05s (physlite_feature_processor.py:1408)
2025-06-27 16:04:16 [    INFO]   Rate: 3702.8 events/s (physlite_feature_processor.py:1409)
2025-06-27 16:04:16 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/atlas_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 16:04:16 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/atlas_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 16:04:16 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 16:04:16 [    INFO] Processing run 00311481 (dataset_manager.py:283)
2025-06-27 16:04:16 [    INFO] Processing ATLAS data for run 00311481 (physlite_feature_processor.py:1003)
2025-06-27 16:04:16 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 16:04:16 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 16:04:16 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 16:04:16 [    INFO] [debug] Initially required branches (incl. derived): {'InDetTrackParticlesAuxDyn.z0', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'MET_Core_AnalysisMETAuxDyn.mpy', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.pt', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1033)
2025-06-27 16:04:16 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1061)
2025-06-27 16:04:16 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF'} (physlite_feature_processor.py:1064)
2025-06-27 16:04:16 [    INFO] Actual branches to read from file: {'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.numberDoF', 'MET_Core_AnalysisMETAuxDyn.mpy', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.d0', 'InDetTrackParticlesAuxDyn.chiSquared', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1067)
2025-06-27 16:04:16 [    INFO] Getting catalog paths for run 00311481 and signal None (physlite_feature_processor.py:1079)
2025-06-27 16:04:16 [    INFO] Found 2 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 16:04:16 [    INFO] Plotting enabled. Aiming for ~2500 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 16:04:16 [    INFO] Processing catalog 1/2 with path: atlas_data/catalogs/Run_00311481_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 16:04:22 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 16:04:22 [    INFO]   Total events read: 14689 (physlite_feature_processor.py:1404)
2025-06-27 16:04:22 [    INFO]   Events passing selection (incl. derived calc): 6750 (physlite_feature_processor.py:1405)
2025-06-27 16:04:22 [    INFO]   Processing time: 6.03s (physlite_feature_processor.py:1408)
2025-06-27 16:04:22 [    INFO]   Rate: 2436.7 events/s (physlite_feature_processor.py:1409)
2025-06-27 16:04:22 [    INFO] Processing catalog 2/2 with path: atlas_data/catalogs/Run_00311481_catalog_1.root (physlite_feature_processor.py:1120)
2025-06-27 16:04:28 [    INFO] Catalog 1 summary: (physlite_feature_processor.py:1403)
2025-06-27 16:04:28 [    INFO]   Total events read: 14722 (physlite_feature_processor.py:1404)
2025-06-27 16:04:28 [    INFO]   Events passing selection (incl. derived calc): 6771 (physlite_feature_processor.py:1405)
2025-06-27 16:04:28 [    INFO]   Processing time: 6.23s (physlite_feature_processor.py:1408)
2025-06-27 16:04:28 [    INFO]   Rate: 2362.1 events/s (physlite_feature_processor.py:1409)
2025-06-27 16:04:28 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/atlas_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 16:04:28 [    INFO] Loaded bin edges metadata from /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:2014)
2025-06-27 16:04:28 [    INFO] Feature 'N_Tracks_per_Event': 0 values (0.0%) below bin range, 2 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Feature 'Track d0': 135 values (0.1%) below bin range, 91 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Feature 'Track z0': 120 values (0.1%) below bin range, 191 values (0.2%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Feature 'Track phi': 116 values (0.1%) below bin range, 124 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Feature 'Track Eta': 110 values (0.1%) below bin range, 82 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Feature 'Track pT': 107 values (0.1%) below bin range, 166 values (0.2%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Feature 'Track Reduced Chi2': 102 values (0.1%) below bin range, 154 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:04:28 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/atlas_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 16:04:28 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 16:04:30 [    INFO] Generating labels datasets for 1 labels (dataset_manager.py:345)
2025-06-27 16:04:31 [    INFO] Saved dataset config to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_config.yaml (dataset_manager.py:201)
2025-06-27 16:04:31 [    INFO] Saved dataset info to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_info.json (dataset_manager.py:202)
2025-06-27 16:04:31 [    INFO] Saved configuration with processing stats to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_config.yaml and /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_info.json (dataset_manager.py:415)
2025-06-27 16:04:32 [    INFO] Created/loaded dataset with ID: dataset_runs_00298967-2-00311481_912fb71c (foundation_model_pipeline.py:410)
2025-06-27 16:04:32 [    INFO] Dataset file exists at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/dataset.h5 (foundation_model_pipeline.py:415)
2025-06-27 16:04:32 [    INFO] Dataset file size: 21.31 MB (foundation_model_pipeline.py:416)
2025-06-27 16:04:32 [    INFO] Dataset HDF5 structure: (foundation_model_pipeline.py:423)
2025-06-27 16:04:32 [    INFO]   Group: features (foundation_model_pipeline.py:431)
2025-06-27 16:04:32 [    INFO]   Group: features/aggregated (foundation_model_pipeline.py:431)
2025-06-27 16:04:32 [    INFO]   Dataset: features/aggregated/aggregator_0, Shape: (45628, 30, 6), Type: float32 (foundation_model_pipeline.py:427)
2025-06-27 16:04:32 [    INFO]   Group: labels (foundation_model_pipeline.py:431)
2025-06-27 16:04:32 [    INFO]   Group: labels/config_0 (foundation_model_pipeline.py:431)
2025-06-27 16:04:32 [    INFO]   Group: labels/config_0/aggregated (foundation_model_pipeline.py:431)
2025-06-27 16:04:32 [    INFO]   Dataset: labels/config_0/aggregated/aggregator_0, Shape: (45628, 1, 3), Type: float32 (foundation_model_pipeline.py:427)
2025-06-27 16:04:32 [    INFO] Registering experiment... (foundation_model_pipeline.py:440)
2025-06-27 16:04:32 [    INFO] Experiment info saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/_experiment_info.json (model_registry.py:136)
2025-06-27 16:04:32 [    INFO] Source config file saved as: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/_experiment_config.yaml (model_registry.py:149)
2025-06-27 16:04:32 [    INFO] Created experiment: 001_Foundation_VAE_Model (foundation_model_pipeline.py:461)
2025-06-27 16:04:32 [    INFO] Creating model... (foundation_model_pipeline.py:464)
2025-06-27 16:04:34 [    INFO] Built encoder layers (variational_autoencoder.py:283)
2025-06-27 16:04:34 [    INFO] Built encoder model (variational_autoencoder.py:310)
2025-06-27 16:04:34 [    INFO] Built deterministic encoder model (variational_autoencoder.py:316)
2025-06-27 16:04:34 [    INFO] Built decoder layers (variational_autoencoder.py:341)
2025-06-27 16:04:34 [    INFO] Built decoder model (variational_autoencoder.py:358)
2025-06-27 16:04:34 [    INFO] Completed VAE architecture build (variational_autoencoder.py:369)
2025-06-27 16:04:34 [    INFO] Model created (foundation_model_pipeline.py:477)
2025-06-27 16:04:34 [    INFO] None (foundation_model_pipeline.py:478)
2025-06-27 16:04:34 [    INFO] Setting up model and callbacks... (foundation_model_pipeline.py:481)
2025-06-27 16:04:34 [    INFO] Added BetaSchedule callback: start=0.01, end=0.1, warmup_epochs=1, cycle_epochs=1 (foundation_model_pipeline.py:505)
2025-06-27 16:04:34 [    INFO] Starting training... (foundation_model_pipeline.py:513)
2025-06-27 16:04:34 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:04:34 [    INFO] Will save training plots to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:269)
2025-06-27 16:04:34 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:04:34 [    INFO] Training dataset batches: 36 (model_trainer.py:284)
2025-06-27 16:04:34 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:04:34 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:04:34 [    INFO]   Targets: (1024, 180) (model_trainer.py:289)
2025-06-27 16:04:35 [    INFO] Starting training for 10 epochs (model_trainer.py:28)
2025-06-27 16:04:35 [    INFO] Epoch 1: beta = 0.0100 (variational_autoencoder.py:218)
2025-06-27 16:04:35 [    INFO] Starting epoch 1/10 (model_trainer.py:32)
2025-06-27 16:04:39 [    INFO] Epoch 1/10 completed in 4.5s - loss: 5.224347 - mse: 2.595938 - total_loss: 2.624410 - reconstruction_loss: 2.591950 - kl_loss: 3.246049 - val_loss: 3.097237 - val_mse: 1.545194 - val_total_loss: 1.545229 - val_reconstruction_loss: 1.538358 - val_kl_loss: 0.687142 (model_trainer.py:37)
2025-06-27 16:04:39 [    INFO] Epoch 2: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:04:39 [    INFO] Starting epoch 2/10 (model_trainer.py:32)
2025-06-27 16:04:43 [    INFO] Epoch 2/10 completed in 4.1s - loss: 4.340996 - mse: 2.089308 - total_loss: 2.248551 - reconstruction_loss: 2.086359 - kl_loss: 2.948954 - val_loss: 2.914034 - val_mse: 1.434435 - val_total_loss: 1.471736 - val_reconstruction_loss: 1.426593 - val_kl_loss: 0.820790 (model_trainer.py:37)
2025-06-27 16:04:43 [    INFO] Epoch 3: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:04:43 [    INFO] Starting epoch 3/10 (model_trainer.py:32)
2025-06-27 16:04:47 [    INFO] Epoch 3/10 completed in 4.1s - loss: 3.611166 - mse: 1.734564 - total_loss: 1.874299 - reconstruction_loss: 1.732310 - kl_loss: 2.581625 - val_loss: 2.749548 - val_mse: 1.346183 - val_total_loss: 1.396823 - val_reconstruction_loss: 1.339644 - val_kl_loss: 1.039626 (model_trainer.py:37)
2025-06-27 16:04:47 [    INFO] Epoch 4: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:04:47 [    INFO] Starting epoch 4/10 (model_trainer.py:32)
2025-06-27 16:04:52 [    INFO] Epoch 4/10 completed in 4.3s - loss: 3.072095 - mse: 1.465771 - total_loss: 1.604205 - reconstruction_loss: 1.463704 - kl_loss: 2.554561 - val_loss: 2.570878 - val_mse: 1.248633 - val_total_loss: 1.315489 - val_reconstruction_loss: 1.241993 - val_kl_loss: 1.336305 (model_trainer.py:37)
2025-06-27 16:04:52 [    INFO] Epoch 5: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:04:52 [    INFO] Starting epoch 5/10 (model_trainer.py:32)
2025-06-27 16:04:56 [    INFO] Epoch 5/10 completed in 3.9s - loss: 2.674267 - mse: 1.265643 - total_loss: 1.406939 - reconstruction_loss: 1.264008 - kl_loss: 2.598739 - val_loss: 2.407925 - val_mse: 1.159358 - val_total_loss: 1.242717 - val_reconstruction_loss: 1.153536 - val_kl_loss: 1.621481 (model_trainer.py:37)
2025-06-27 16:04:56 [    INFO] Epoch 6: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:04:56 [    INFO] Starting epoch 6/10 (model_trainer.py:32)
2025-06-27 16:05:00 [    INFO] Epoch 6/10 completed in 4.1s - loss: 2.399447 - mse: 1.128959 - total_loss: 1.269124 - reconstruction_loss: 1.127671 - kl_loss: 2.571872 - val_loss: 2.265587 - val_mse: 1.081277 - val_total_loss: 1.178516 - val_reconstruction_loss: 1.075489 - val_kl_loss: 1.873221 (model_trainer.py:37)
2025-06-27 16:05:00 [    INFO] Epoch 7: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:05:00 [    INFO] Starting epoch 7/10 (model_trainer.py:32)
2025-06-27 16:05:04 [    INFO] Epoch 7/10 completed in 4.2s - loss: 2.203056 - mse: 1.032599 - total_loss: 1.169080 - reconstruction_loss: 1.031318 - kl_loss: 2.504765 - val_loss: 2.161419 - val_mse: 1.024934 - val_total_loss: 1.131234 - val_reconstruction_loss: 1.019574 - val_kl_loss: 2.030176 (model_trainer.py:37)
2025-06-27 16:05:04 [    INFO] Epoch 8: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:05:04 [    INFO] Starting epoch 8/10 (model_trainer.py:32)
2025-06-27 16:05:08 [    INFO] Epoch 8/10 completed in 4.2s - loss: 2.060504 - mse: 0.964408 - total_loss: 1.094765 - reconstruction_loss: 0.963151 - kl_loss: 2.392984 - val_loss: 2.061921 - val_mse: 0.972746 - val_total_loss: 1.083441 - val_reconstruction_loss: 0.966988 - val_kl_loss: 2.117324 (model_trainer.py:37)
2025-06-27 16:05:08 [    INFO] Epoch 9: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:05:08 [    INFO] Starting epoch 9/10 (model_trainer.py:32)
2025-06-27 16:05:12 [    INFO] Epoch 9/10 completed in 4.2s - loss: 1.955423 - mse: 0.916072 - total_loss: 1.038227 - reconstruction_loss: 0.915034 - kl_loss: 2.239869 - val_loss: 1.993798 - val_mse: 0.939455 - val_total_loss: 1.048239 - val_reconstruction_loss: 0.933360 - val_kl_loss: 2.088721 (model_trainer.py:37)
2025-06-27 16:05:12 [    INFO] Epoch 10: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 16:05:12 [    INFO] Starting epoch 10/10 (model_trainer.py:32)
2025-06-27 16:05:17 [    INFO] Epoch 10/10 completed in 4.3s - loss: 1.877931 - mse: 0.881149 - total_loss: 0.995732 - reconstruction_loss: 0.880179 - kl_loss: 2.100972 - val_loss: 1.939210 - val_mse: 0.913190 - val_total_loss: 1.019794 - val_reconstruction_loss: 0.907017 - val_kl_loss: 2.050490 (model_trainer.py:37)
2025-06-27 16:05:17 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:17 [    INFO]   loss: 1.877931 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   mse: 0.881149 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   total_loss: 0.995732 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   reconstruction_loss: 0.880179 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   kl_loss: 2.100972 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   val_loss: 1.939210 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   val_mse: 0.913190 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   val_total_loss: 1.019794 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   val_reconstruction_loss: 0.907017 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO]   val_kl_loss: 2.050490 (model_trainer.py:329)
2025-06-27 16:05:17 [    INFO] Generating training plots... (model_trainer.py:333)
2025-06-27 16:05:17 [    INFO] Creating training plots in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:344)
2025-06-27 16:05:17 [    INFO] Creating VAE-specific plots... (variational_autoencoder.py:387)
2025-06-27 16:05:17 [    INFO] Available metrics: ['loss', 'mse', 'total_loss', 'reconstruction_loss', 'kl_loss', 'val_loss', 'val_mse', 'val_total_loss', 'val_reconstruction_loss', 'val_kl_loss'] (variational_autoencoder.py:397)
2025-06-27 16:05:19 [    INFO] Created training history plot (variational_autoencoder.py:499)
2025-06-27 16:05:19 [    INFO] VAE plots saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (variational_autoencoder.py:559)
2025-06-27 16:05:19 [    INFO] Plots saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:399)
2025-06-27 16:05:19 [    INFO] Generating result plots... (model_trainer.py:337)
2025-06-27 16:05:19 [    INFO] Creating result plots in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:411)
2025-06-27 16:05:19 [    INFO] Sampling up to 5000 events for result plotting (model_trainer.py:427)
2025-06-27 16:05:24 [    INFO] Collected 821340 samples for result plotting (model_trainer.py:468)
2025-06-27 16:05:29 [    INFO] Result plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training/result_percent_error.png (model_trainer.py:567)
2025-06-27 16:05:29 [    INFO] Raw result data saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training/result_percent_error_data.json (model_trainer.py:568)
2025-06-27 16:05:29 [    INFO] Result statistics - Mean: 183.925, Std: 194.947, Median: 106.761 (model_trainer.py:569)
2025-06-27 16:05:29 [    INFO] Evaluating model... (foundation_model_pipeline.py:528)
2025-06-27 16:05:29 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:29 [    INFO]   test_loss: 1.739644 (model_trainer.py:595)
2025-06-27 16:05:29 [    INFO]   test_mse: 0.814442 (model_trainer.py:595)
2025-06-27 16:05:29 [    INFO]   test_total_loss: 0.921733 (model_trainer.py:595)
2025-06-27 16:05:29 [    INFO]   test_reconstruction_loss: 0.811127 (model_trainer.py:595)
2025-06-27 16:05:29 [    INFO]   test_kl_loss: 2.011018 (model_trainer.py:595)
2025-06-27 16:05:29 [    INFO] Training results saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_registry.py:234)
2025-06-27 16:05:29 [    INFO] Saving trained model... (foundation_model_pipeline.py:547)
2025-06-27 16:05:29 [ WARNING] Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model. (saving_utils.py:359)
2025-06-27 16:05:31 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/encoder/assets (builder_impl.py:804)
2025-06-27 16:05:31 [ WARNING] Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model. (saving_utils.py:359)
2025-06-27 16:05:32 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/deterministic_encoder/assets (builder_impl.py:804)
2025-06-27 16:05:32 [ WARNING] Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model. (saving_utils.py:359)
2025-06-27 16:05:33 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/decoder/assets (builder_impl.py:804)
2025-06-27 16:05:38 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/full_model/assets (builder_impl.py:804)
2025-06-27 16:05:38 [    INFO] Model saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model (model_registry.py:277)
2025-06-27 16:05:38 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:592)
2025-06-27 16:05:38 [    INFO] Experiment Results (foundation_model_pipeline.py:593)
2025-06-27 16:05:38 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:594)
2025-06-27 16:05:38 [    INFO] Experiment ID: 001_Foundation_VAE_Model (foundation_model_pipeline.py:598)
2025-06-27 16:05:38 [    INFO] Status: completed (foundation_model_pipeline.py:599)
2025-06-27 16:05:38 [    INFO] Training Duration: 42.14s (foundation_model_pipeline.py:603)
2025-06-27 16:05:38 [    INFO] Epochs Completed: 10 (foundation_model_pipeline.py:606)
2025-06-27 16:05:38 [    INFO] Metrics: (foundation_model_pipeline.py:610)
2025-06-27 16:05:38 [    INFO]   loss: 1.877931 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   mse: 0.881149 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   total_loss: 0.995732 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   reconstruction_loss: 0.880179 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   kl_loss: 2.100972 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   val_loss: 1.939210 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   val_mse: 0.913190 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   val_total_loss: 1.019794 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   val_reconstruction_loss: 0.907017 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   val_kl_loss: 2.050490 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   test_loss: 1.739644 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   test_mse: 0.814442 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   test_total_loss: 0.921733 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   test_reconstruction_loss: 0.811127 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO]   test_kl_loss: 2.011018 (foundation_model_pipeline.py:620)
2025-06-27 16:05:38 [    INFO] Foundation model training completed successfully (foundation_model_pipeline.py:626)
2025-06-27 16:05:38 [    INFO] Foundation model saved at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:630)
2025-06-27 16:05:38 [    INFO] Training completed successfully. Model saved at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:247)
2025-06-27 16:05:38 [    INFO]
================================================== (foundation_model_pipeline.py:252)
2025-06-27 16:05:38 [    INFO] STEP 2/4: REGRESSION EVALUATION (foundation_model_pipeline.py:253)
2025-06-27 16:05:38 [    INFO] ================================================== (foundation_model_pipeline.py:254)
2025-06-27 16:05:38 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:913)
2025-06-27 16:05:38 [    INFO] Evaluating Foundation Model for Regression (Data Efficiency Study) (foundation_model_pipeline.py:914)
2025-06-27 16:05:38 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:917)
2025-06-27 16:05:38 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 16:05:38 [    INFO] Loading full dataset with regression labels... (foundation_model_pipeline.py:934)
2025-06-27 16:05:38 [    INFO] Loading datasets (dataset_manager.py:802)
2025-06-27 16:05:38 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:05:39 [    INFO] Total training events available: 36503 (foundation_model_pipeline.py:951)
2025-06-27 16:05:39 [    INFO] Data sizes to test: [1000, 2000] (foundation_model_pipeline.py:959)
2025-06-27 16:05:39 [    INFO] Loading foundation model configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:962)
2025-06-27 16:05:39 [    INFO] Loading pre-trained deterministic encoder from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/deterministic_encoder (foundation_model_pipeline.py:1005)
2025-06-27 16:05:39 [ WARNING] No training configuration found in save file, so the model was *not* compiled. Compile it manually. (load.py:178)
2025-06-27 16:05:39 [    INFO] Loaded deterministic encoder with output shape: (None, 2) (foundation_model_pipeline.py:1012)
2025-06-27 16:05:39 [    INFO] Deterministic encoder layers: (foundation_model_pipeline.py:1015)
2025-06-27 16:05:39 [    INFO]   encoder_input: [(None, 180)] (foundation_model_pipeline.py:1017)
2025-06-27 16:05:39 [    INFO]   reshape: (None, 180) (foundation_model_pipeline.py:1017)
2025-06-27 16:05:39 [    INFO]   encoder_0_dense: (None, 8) (foundation_model_pipeline.py:1017)
2025-06-27 16:05:39 [    INFO]   encoder_0_activation: (None, 8) (foundation_model_pipeline.py:1017)
2025-06-27 16:05:39 [    INFO]   encoder_0_bn: (None, 8) (foundation_model_pipeline.py:1017)
2025-06-27 16:05:39 [    INFO]   z_mean: (None, 2) (foundation_model_pipeline.py:1017)
2025-06-27 16:05:39 [    INFO]
================================================== (foundation_model_pipeline.py:1131)
2025-06-27 16:05:39 [    INFO] Training with 1000 events (foundation_model_pipeline.py:1132)
2025-06-27 16:05:39 [    INFO] ================================================== (foundation_model_pipeline.py:1133)
2025-06-27 16:05:39 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1139)
2025-06-27 16:05:40 [    INFO] Training From_Scratch model with 1000 events... (foundation_model_pipeline.py:1067)
2025-06-27 16:05:40 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:05:40 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:05:40 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:05:40 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:05:40 [    INFO]   Features: (1000, 180) (model_trainer.py:288)
2025-06-27 16:05:40 [    INFO]   Targets: (1000, 3) (model_trainer.py:289)
2025-06-27 16:05:40 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:05:40 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:05:41 [    INFO] Epoch 1/3 completed in 0.3s - loss: 4.748996 - mse: 4.748842 - mae: 1.633354 - val_loss: 1.961256 - val_mse: 1.961102 - val_mae: 1.038322 (model_trainer.py:37)
2025-06-27 16:05:41 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:05:41 [    INFO] Epoch 2/3 completed in 0.3s - loss: 4.948338 - mse: 4.948184 - mae: 1.675593 - val_loss: 1.955715 - val_mse: 1.955561 - val_mae: 1.036942 (model_trainer.py:37)
2025-06-27 16:05:41 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:05:41 [    INFO] Epoch 3/3 completed in 0.3s - loss: 4.599101 - mse: 4.598947 - mae: 1.634086 - val_loss: 1.951707 - val_mse: 1.951554 - val_mae: 1.035957 (model_trainer.py:37)
2025-06-27 16:05:41 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:41 [    INFO]   loss: 4.599101 (model_trainer.py:329)
2025-06-27 16:05:41 [    INFO]   mse: 4.598947 (model_trainer.py:329)
2025-06-27 16:05:41 [    INFO]   mae: 1.634086 (model_trainer.py:329)
2025-06-27 16:05:41 [    INFO]   val_loss: 1.951707 (model_trainer.py:329)
2025-06-27 16:05:41 [    INFO]   val_mse: 1.951554 (model_trainer.py:329)
2025-06-27 16:05:41 [    INFO]   val_mae: 1.035957 (model_trainer.py:329)
2025-06-27 16:05:42 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:42 [    INFO]   test_loss: 2.025987 (model_trainer.py:595)
2025-06-27 16:05:42 [    INFO]   test_mse: 2.025834 (model_trainer.py:595)
2025-06-27 16:05:42 [    INFO]   test_mae: 1.048831 (model_trainer.py:595)
2025-06-27 16:05:42 [    INFO] From_Scratch with 1000 events - Test Loss: 2.025987 (foundation_model_pipeline.py:1109)
2025-06-27 16:05:42 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1182)
2025-06-27 16:05:42 [    INFO] Training Fine_Tuned model with 1000 events... (foundation_model_pipeline.py:1067)
2025-06-27 16:05:42 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:05:42 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:05:42 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:05:42 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:05:42 [    INFO]   Features: (1000, 180) (model_trainer.py:288)
2025-06-27 16:05:42 [    INFO]   Targets: (1000, 3) (model_trainer.py:289)
2025-06-27 16:05:42 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:05:42 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:05:43 [    INFO] Epoch 1/3 completed in 0.6s - loss: 4.156621 - mse: 4.156433 - mae: 1.736890 - val_loss: 2.883148 - val_mse: 2.882960 - val_mae: 1.342429 (model_trainer.py:37)
2025-06-27 16:05:43 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:05:43 [    INFO] Epoch 2/3 completed in 0.4s - loss: 4.046271 - mse: 4.046083 - mae: 1.713151 - val_loss: 2.874438 - val_mse: 2.874250 - val_mae: 1.339272 (model_trainer.py:37)
2025-06-27 16:05:43 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:05:43 [    INFO] Epoch 3/3 completed in 0.3s - loss: 4.034032 - mse: 4.033844 - mae: 1.705695 - val_loss: 2.857480 - val_mse: 2.857292 - val_mae: 1.333848 (model_trainer.py:37)
2025-06-27 16:05:43 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:43 [    INFO]   loss: 4.034032 (model_trainer.py:329)
2025-06-27 16:05:43 [    INFO]   mse: 4.033844 (model_trainer.py:329)
2025-06-27 16:05:43 [    INFO]   mae: 1.705695 (model_trainer.py:329)
2025-06-27 16:05:43 [    INFO]   val_loss: 2.857480 (model_trainer.py:329)
2025-06-27 16:05:43 [    INFO]   val_mse: 2.857292 (model_trainer.py:329)
2025-06-27 16:05:43 [    INFO]   val_mae: 1.333848 (model_trainer.py:329)
2025-06-27 16:05:44 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:44 [    INFO]   test_loss: 2.947477 (model_trainer.py:595)
2025-06-27 16:05:44 [    INFO]   test_mse: 2.947289 (model_trainer.py:595)
2025-06-27 16:05:44 [    INFO]   test_mae: 1.349073 (model_trainer.py:595)
2025-06-27 16:05:44 [    INFO] Fine_Tuned with 1000 events - Test Loss: 2.947477 (foundation_model_pipeline.py:1109)
2025-06-27 16:05:44 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1216)
2025-06-27 16:05:44 [    INFO] Training Fixed_Encoder model with 1000 events... (foundation_model_pipeline.py:1067)
2025-06-27 16:05:44 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:05:44 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:05:44 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:05:44 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:05:44 [    INFO]   Features: (1000, 180) (model_trainer.py:288)
2025-06-27 16:05:44 [    INFO]   Targets: (1000, 3) (model_trainer.py:289)
2025-06-27 16:05:44 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:05:44 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:05:44 [    INFO] Epoch 1/3 completed in 0.3s - loss: 5.043473 - mse: 5.043344 - mae: 1.830157 - val_loss: 2.211124 - val_mse: 2.210995 - val_mae: 1.140486 (model_trainer.py:37)
2025-06-27 16:05:44 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:05:45 [    INFO] Epoch 2/3 completed in 0.3s - loss: 5.052853 - mse: 5.052723 - mae: 1.839589 - val_loss: 2.212312 - val_mse: 2.212183 - val_mae: 1.140180 (model_trainer.py:37)
2025-06-27 16:05:45 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:05:45 [    INFO] Epoch 3/3 completed in 0.3s - loss: 5.053005 - mse: 5.052876 - mae: 1.829458 - val_loss: 2.204206 - val_mse: 2.204077 - val_mae: 1.136804 (model_trainer.py:37)
2025-06-27 16:05:45 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:45 [    INFO]   loss: 5.053005 (model_trainer.py:329)
2025-06-27 16:05:45 [    INFO]   mse: 5.052876 (model_trainer.py:329)
2025-06-27 16:05:45 [    INFO]   mae: 1.829458 (model_trainer.py:329)
2025-06-27 16:05:45 [    INFO]   val_loss: 2.204206 (model_trainer.py:329)
2025-06-27 16:05:45 [    INFO]   val_mse: 2.204077 (model_trainer.py:329)
2025-06-27 16:05:45 [    INFO]   val_mae: 1.136804 (model_trainer.py:329)
2025-06-27 16:05:45 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:45 [    INFO]   test_loss: 2.244069 (model_trainer.py:595)
2025-06-27 16:05:45 [    INFO]   test_mse: 2.243939 (model_trainer.py:595)
2025-06-27 16:05:45 [    INFO]   test_mae: 1.140021 (model_trainer.py:595)
2025-06-27 16:05:45 [    INFO] Fixed_Encoder with 1000 events - Test Loss: 2.244069 (foundation_model_pipeline.py:1109)
2025-06-27 16:05:45 [    INFO]
================================================== (foundation_model_pipeline.py:1131)
2025-06-27 16:05:45 [    INFO] Training with 2000 events (foundation_model_pipeline.py:1132)
2025-06-27 16:05:45 [    INFO] ================================================== (foundation_model_pipeline.py:1133)
2025-06-27 16:05:45 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1139)
2025-06-27 16:05:46 [    INFO] Enabling training and result plots for From Scratch model with 2000 events (largest size) (foundation_model_pipeline.py:1172)
2025-06-27 16:05:46 [    INFO] Training From_Scratch model with 2000 events... (foundation_model_pipeline.py:1067)
2025-06-27 16:05:46 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:05:46 [    INFO] Will save training plots to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/training_plots (model_trainer.py:269)
2025-06-27 16:05:46 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:05:46 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:05:46 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:05:46 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:05:46 [    INFO]   Targets: (1024, 3) (model_trainer.py:289)
2025-06-27 16:05:46 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:05:46 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:05:46 [    INFO] Epoch 1/3 completed in 0.4s - loss: 2.259210 - mse: 2.259134 - mae: 1.170967 - val_loss: 1.903639 - val_mse: 1.903563 - val_mae: 1.019105 (model_trainer.py:37)
2025-06-27 16:05:46 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:05:46 [    INFO] Epoch 2/3 completed in 0.3s - loss: 2.210952 - mse: 2.210877 - mae: 1.157627 - val_loss: 1.875485 - val_mse: 1.875409 - val_mae: 1.009753 (model_trainer.py:37)
2025-06-27 16:05:46 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:05:47 [    INFO] Epoch 3/3 completed in 0.3s - loss: 2.122556 - mse: 2.122480 - mae: 1.129835 - val_loss: 1.864589 - val_mse: 1.864513 - val_mae: 1.006256 (model_trainer.py:37)
2025-06-27 16:05:47 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:47 [    INFO]   loss: 2.122556 (model_trainer.py:329)
2025-06-27 16:05:47 [    INFO]   mse: 2.122480 (model_trainer.py:329)
2025-06-27 16:05:47 [    INFO]   mae: 1.129835 (model_trainer.py:329)
2025-06-27 16:05:47 [    INFO]   val_loss: 1.864589 (model_trainer.py:329)
2025-06-27 16:05:47 [    INFO]   val_mse: 1.864513 (model_trainer.py:329)
2025-06-27 16:05:47 [    INFO]   val_mae: 1.006256 (model_trainer.py:329)
2025-06-27 16:05:47 [    INFO] Generating training plots... (model_trainer.py:333)
2025-06-27 16:05:47 [    INFO] Creating training plots in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/training_plots (model_trainer.py:344)
2025-06-27 16:05:48 [    INFO] Plots saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/training_plots (model_trainer.py:399)
2025-06-27 16:05:48 [    INFO] Generating result plots... (model_trainer.py:337)
2025-06-27 16:05:48 [    INFO] Creating result plots in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/training_plots (model_trainer.py:411)
2025-06-27 16:05:48 [    INFO] Sampling up to 5000 events for result plotting (model_trainer.py:427)
2025-06-27 16:05:50 [    INFO] Collected 13689 samples for result plotting (model_trainer.py:468)
2025-06-27 16:05:51 [    INFO] Result plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/training_plots/result_percent_error.png (model_trainer.py:567)
2025-06-27 16:05:51 [    INFO] Raw result data saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/training_plots/result_percent_error_data.json (model_trainer.py:568)
2025-06-27 16:05:51 [    INFO] Result statistics - Mean: 149.414, Std: 139.332, Median: 110.238 (model_trainer.py:569)
2025-06-27 16:05:51 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:51 [    INFO]   test_loss: 1.969813 (model_trainer.py:595)
2025-06-27 16:05:51 [    INFO]   test_mse: 1.969738 (model_trainer.py:595)
2025-06-27 16:05:51 [    INFO]   test_mae: 1.027901 (model_trainer.py:595)
2025-06-27 16:05:51 [    INFO] From_Scratch with 2000 events - Test Loss: 1.969813 (foundation_model_pipeline.py:1109)
2025-06-27 16:05:51 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1182)
2025-06-27 16:05:51 [    INFO] Training Fine_Tuned model with 2000 events... (foundation_model_pipeline.py:1067)
2025-06-27 16:05:51 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:05:51 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:05:51 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:05:51 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:05:51 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:05:51 [    INFO]   Targets: (1024, 3) (model_trainer.py:289)
2025-06-27 16:05:51 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:05:52 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:05:52 [    INFO] Epoch 1/3 completed in 0.4s - loss: 5.376260 - mse: 5.376056 - mae: 2.028227 - val_loss: 2.515567 - val_mse: 2.515363 - val_mae: 1.260959 (model_trainer.py:37)
2025-06-27 16:05:52 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:05:52 [    INFO] Epoch 2/3 completed in 0.4s - loss: 5.225815 - mse: 5.225612 - mae: 1.983712 - val_loss: 2.513591 - val_mse: 2.513387 - val_mae: 1.259404 (model_trainer.py:37)
2025-06-27 16:05:52 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:05:53 [    INFO] Epoch 3/3 completed in 0.4s - loss: 5.213952 - mse: 5.213748 - mae: 1.981156 - val_loss: 2.492110 - val_mse: 2.491906 - val_mae: 1.253131 (model_trainer.py:37)
2025-06-27 16:05:53 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:53 [    INFO]   loss: 5.213952 (model_trainer.py:329)
2025-06-27 16:05:53 [    INFO]   mse: 5.213748 (model_trainer.py:329)
2025-06-27 16:05:53 [    INFO]   mae: 1.981156 (model_trainer.py:329)
2025-06-27 16:05:53 [    INFO]   val_loss: 2.492110 (model_trainer.py:329)
2025-06-27 16:05:53 [    INFO]   val_mse: 2.491906 (model_trainer.py:329)
2025-06-27 16:05:53 [    INFO]   val_mae: 1.253131 (model_trainer.py:329)
2025-06-27 16:05:53 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:53 [    INFO]   test_loss: 2.605625 (model_trainer.py:595)
2025-06-27 16:05:53 [    INFO]   test_mse: 2.605421 (model_trainer.py:595)
2025-06-27 16:05:53 [    INFO]   test_mae: 1.277150 (model_trainer.py:595)
2025-06-27 16:05:53 [    INFO] Fine_Tuned with 2000 events - Test Loss: 2.605625 (foundation_model_pipeline.py:1109)
2025-06-27 16:05:53 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1216)
2025-06-27 16:05:53 [    INFO] Training Fixed_Encoder model with 2000 events... (foundation_model_pipeline.py:1067)
2025-06-27 16:05:53 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:05:53 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:05:53 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:05:53 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:05:53 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:05:53 [    INFO]   Targets: (1024, 3) (model_trainer.py:289)
2025-06-27 16:05:53 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:05:54 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:05:54 [    INFO] Epoch 1/3 completed in 0.4s - loss: 2.979214 - mse: 2.979048 - mae: 1.368449 - val_loss: 2.365270 - val_mse: 2.365105 - val_mae: 1.144928 (model_trainer.py:37)
2025-06-27 16:05:54 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:05:54 [    INFO] Epoch 2/3 completed in 0.4s - loss: 2.933563 - mse: 2.933397 - mae: 1.354799 - val_loss: 2.343408 - val_mse: 2.343242 - val_mae: 1.139849 (model_trainer.py:37)
2025-06-27 16:05:54 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:05:55 [    INFO] Epoch 3/3 completed in 0.3s - loss: 2.890720 - mse: 2.890555 - mae: 1.349134 - val_loss: 2.326622 - val_mse: 2.326457 - val_mae: 1.135379 (model_trainer.py:37)
2025-06-27 16:05:55 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:05:55 [    INFO]   loss: 2.890720 (model_trainer.py:329)
2025-06-27 16:05:55 [    INFO]   mse: 2.890555 (model_trainer.py:329)
2025-06-27 16:05:55 [    INFO]   mae: 1.349134 (model_trainer.py:329)
2025-06-27 16:05:55 [    INFO]   val_loss: 2.326622 (model_trainer.py:329)
2025-06-27 16:05:55 [    INFO]   val_mse: 2.326457 (model_trainer.py:329)
2025-06-27 16:05:55 [    INFO]   val_mae: 1.135379 (model_trainer.py:329)
2025-06-27 16:05:55 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:05:55 [    INFO]   test_loss: 2.414428 (model_trainer.py:595)
2025-06-27 16:05:55 [    INFO]   test_mse: 2.414263 (model_trainer.py:595)
2025-06-27 16:05:55 [    INFO]   test_mae: 1.146535 (model_trainer.py:595)
2025-06-27 16:05:55 [    INFO] Fixed_Encoder with 2000 events - Test Loss: 2.414428 (foundation_model_pipeline.py:1109)
2025-06-27 16:05:55 [    INFO] Creating data efficiency plot... (foundation_model_pipeline.py:1250)
2025-06-27 16:05:55 [    INFO] Results saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/regression_data_efficiency_results.json (foundation_model_pipeline.py:1256)
2025-06-27 16:05:56 [    INFO] Data efficiency plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/regression_data_efficiency_plot.png (foundation_model_pipeline.py:1318)
2025-06-27 16:05:56 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1324)
2025-06-27 16:05:56 [    INFO] Regression Evaluation Results Summary (foundation_model_pipeline.py:1325)
2025-06-27 16:05:56 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1326)
2025-06-27 16:05:56 [    INFO] Training Events: 1000 (foundation_model_pipeline.py:1329)
2025-06-27 16:05:56 [    INFO]   From Scratch:  2.025987 (foundation_model_pipeline.py:1330)
2025-06-27 16:05:56 [    INFO]   Fine-Tuned:    2.947477 (foundation_model_pipeline.py:1331)
2025-06-27 16:05:56 [    INFO]   Fixed Encoder: 2.244069 (foundation_model_pipeline.py:1332)
2025-06-27 16:05:56 [    INFO]   Fine-Tuned improvement: -45.5% (foundation_model_pipeline.py:1346)
2025-06-27 16:05:56 [    INFO]   Fixed improvement: -10.8% (foundation_model_pipeline.py:1347)
2025-06-27 16:05:56 [    INFO]  (foundation_model_pipeline.py:1348)
2025-06-27 16:05:56 [    INFO] Training Events: 2000 (foundation_model_pipeline.py:1329)
2025-06-27 16:05:56 [    INFO]   From Scratch:  1.969813 (foundation_model_pipeline.py:1330)
2025-06-27 16:05:56 [    INFO]   Fine-Tuned:    2.605625 (foundation_model_pipeline.py:1331)
2025-06-27 16:05:56 [    INFO]   Fixed Encoder: 2.414428 (foundation_model_pipeline.py:1332)
2025-06-27 16:05:56 [    INFO]   Fine-Tuned improvement: -32.3% (foundation_model_pipeline.py:1346)
2025-06-27 16:05:56 [    INFO]   Fixed improvement: -22.6% (foundation_model_pipeline.py:1347)
2025-06-27 16:05:56 [    INFO]  (foundation_model_pipeline.py:1348)
2025-06-27 16:05:56 [    INFO] Regression evaluation completed successfully (foundation_model_pipeline.py:1350)
2025-06-27 16:05:56 [    INFO] Regression evaluation completed successfully (foundation_model_pipeline.py:272)
2025-06-27 16:05:56 [    INFO]
================================================== (foundation_model_pipeline.py:275)
2025-06-27 16:05:56 [    INFO] STEP 3/4: SIGNAL CLASSIFICATION EVALUATION (foundation_model_pipeline.py:276)
2025-06-27 16:05:56 [    INFO] ================================================== (foundation_model_pipeline.py:277)
2025-06-27 16:05:56 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1388)
2025-06-27 16:05:56 [    INFO] Evaluating Foundation Model for Signal Classification (Data Efficiency Study) (foundation_model_pipeline.py:1389)
2025-06-27 16:05:56 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1392)
2025-06-27 16:05:56 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 16:05:56 [    INFO] Loading background dataset... (foundation_model_pipeline.py:1415)
2025-06-27 16:05:56 [    INFO] Loading datasets (dataset_manager.py:802)
2025-06-27 16:05:56 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:05:56 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:05:56 [    INFO] Found background histogram data for comparison at /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/atlas_dataset_features_hist_data.json (foundation_model_pipeline.py:1440)
2025-06-27 16:05:56 [    INFO] Loading signal dataset: zprime_tt (foundation_model_pipeline.py:1450)
2025-06-27 16:05:56 [    INFO] Loading signal datasets (dataset_manager.py:883)
2025-06-27 16:05:56 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:05:56 [    INFO] [Debug] Creating new signal dataset (dataset_manager.py:476)
2025-06-27 16:05:56 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:05:56 [    INFO] [Debug] Signal dataset directory: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:453)
2025-06-27 16:05:56 [    INFO] [Debug] Signal dataset path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/signal_dataset.h5 (dataset_manager.py:454)
2025-06-27 16:05:56 [    INFO] [Debug] Signal config path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_config.yaml (dataset_manager.py:455)
2025-06-27 16:05:56 [    INFO] [Debug] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:485)
2025-06-27 16:05:56 [    INFO] [Debug] Signal keys to process: ['zprime_tt', 'zprime_bb'] (dataset_manager.py:486)
2025-06-27 16:05:56 [    INFO] [Debug] Will create dataset at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/signal_dataset.h5 (dataset_manager.py:489)
2025-06-27 16:05:56 [    INFO] [Debug] Created HDF5 file, processing signal types... (dataset_manager.py:496)
2025-06-27 16:05:56 [    INFO] [Debug] Processing signal type: zprime_tt (dataset_manager.py:501)
2025-06-27 16:05:56 [    INFO] [Debug] plot_output for signal JSON data naming: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_tt_dataset_features.png (dataset_manager.py:516)
2025-06-27 16:05:56 [    INFO] Processing signal data for zprime_tt (physlite_feature_processor.py:1001)
2025-06-27 16:05:56 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 16:05:56 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 16:05:56 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 16:05:56 [    INFO] [debug] Initially required branches (incl. derived): {'InDetTrackParticlesAuxDyn.z0', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'MET_Core_AnalysisMETAuxDyn.mpy', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.pt', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1033)
2025-06-27 16:05:56 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1061)
2025-06-27 16:05:56 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF'} (physlite_feature_processor.py:1064)
2025-06-27 16:05:56 [    INFO] Actual branches to read from file: {'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.numberDoF', 'MET_Core_AnalysisMETAuxDyn.mpy', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.d0', 'InDetTrackParticlesAuxDyn.chiSquared', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1067)
2025-06-27 16:05:56 [    INFO] Getting catalog paths for run None and signal zprime_tt (physlite_feature_processor.py:1079)
2025-06-27 16:05:56 [    INFO] Found 1 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 16:05:56 [    INFO] Plotting enabled. Aiming for ~5000 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 16:05:56 [    INFO] Processing catalog 1/1 with path: atlas_data/signal_catalogs/zprime_tt_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 16:05:59 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'InDetTrackParticlesAuxDyn.z0': array([ -0.58651  ,  -1.508032 ,  -1.4327418,  -1.5408484,  -1.5525199,
        -1.469102 ,  -1.1031151,  -1.4984596,  -1.6954488,  -1.5600672,
        -1.383324 ,  -1.5848802,  -1.5659577,  -3.7424617, -48.52611  ,
        -1.4975952,  -1.4187077,  -1.4246764,  -2.056273 ,  -6.5991955,
        -1.6417305,  -0.5975787,  -1.4289072,  -1.5119314,  -1.4564048,
        -2.7279751,  -1.3629615,  -1.409713 ,  -1.5893272,  -1.4522458,
        -1.3744906,  -1.3065273,  -1.4857976,  -1.5164562,  -1.4009899,
        -1.4455857,  -1.5065175,  -1.61813  ,  -2.340205 ,  -2.0381176],
      dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([50., 51., 48., 47., 49., 13., 50., 42., 52., 47., 47., 37., 41.,
       50., 11., 30., 37., 46., 49., 48., 31., 43., 43., 25., 43., 42.,
       49., 45., 32., 42., 32., 41., 46., 48., 44., 40., 45., 42., 43.,
        7.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpy': array([-28080.973  ,   -480.25757], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([-6.88729779e-05, -7.49233222e-05, -4.19900862e-05,  3.11629856e-06,
        2.21594146e-05,  8.60558575e-05, -1.23193995e-05, -1.22602913e-04,
       -7.88225807e-05,  1.54356734e-04, -1.68359576e-04,  2.18319648e-04,
       -1.04862367e-04,  1.58748997e-04,  1.60355085e-05, -1.07529406e-04,
        3.40674451e-04, -2.73564190e-04, -1.63854012e-04,  1.72301836e-04,
       -5.62896545e-04,  2.17947789e-04,  2.89525691e-04,  7.91665167e-04,
       -1.60520591e-04, -3.03287205e-04,  4.79536160e-04, -1.36414499e-04,
        3.70083697e-04,  5.03614574e-05,  1.33430600e-04,  1.37083218e-04,
        8.94576835e-04,  5.38433815e-05,  2.48747710e-05, -1.34258953e-04,
       -3.78335186e-04, -6.94320537e-04,  2.42699934e-05,  1.13653286e-05],
      dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([2.7394533 , 0.99543655, 0.9881067 , 2.7560174 , 0.9784497 ,
       0.83039397, 2.7664912 , 1.0583935 , 1.7444443 , 0.9834595 ,
       1.0973645 , 1.063562  , 1.0092902 , 2.6902037 , 2.9501855 ,
       0.81227714, 0.95550436, 1.9117035 , 2.7410786 , 2.6993623 ,
       0.7534586 , 1.7808875 , 1.7967434 , 1.2805961 , 1.8171558 ,
       1.6834267 , 1.2763314 , 0.9945401 , 0.8341607 , 1.0284545 ,
       0.7160402 , 2.819237  , 1.2278451 , 1.7918589 , 1.7703563 ,
       2.132401  , 1.5949131 , 1.0877056 , 1.760426  , 1.763081  ],
      dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([ 0.06315981,  0.02641817,  0.00526722, -0.03166306,  0.01539994,
        0.00645554,  0.09361396, -0.02334598, -0.04410928,  0.0078935 ,
        0.02875908,  0.00939019,  0.00270811,  0.16586912, -0.00861183,
        0.00786774,  0.07261597, -0.01097151,  0.62327695, -0.835527  ,
        0.07823467,  0.3680812 ,  0.02261261, -0.01511043,  0.00495181,
       -0.49200642,  0.05088731,  0.02342756, -0.02001536, -0.01254166,
        0.01431257,  0.0597809 ,  0.0397876 ,  0.01565352, -0.99626076,
       -0.00137191, -0.02123706,  0.32294223, -0.07225598, -0.23380579],
      dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([39.68761  , 45.527416 , 40.54496  , 55.20232  , 39.10388  ,
        6.746427 , 52.09819  , 25.88393  , 78.54185  , 49.836346 ,
       55.51817  , 33.003494 , 35.32415  , 59.210575 , 14.982703 ,
       36.490086 , 21.66626  , 45.031586 , 59.360317 , 42.974243 ,
       50.606705 , 36.700672 , 44.929665 , 29.943033 , 39.71574  ,
       44.76934  , 49.024624 , 41.543846 , 21.30998  , 41.158524 ,
       25.162868 , 40.444157 , 37.355495 , 47.007572 , 62.59239  ,
       41.839622 , 43.46009  , 34.444775 , 85.971    ,  6.4204445],
      dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([13848.573,  5955.593], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([134062.75 ,  17650.158], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([-0.05818282,  1.3982899 ,  1.5341188 ,  0.6163037 ,  1.5186731 ,
        1.4913832 , -0.10213986,  1.412859  , -2.432485  ,  1.4673381 ,
        1.314496  ,  1.3474834 ,  1.3524413 , -0.11480629, -2.3178213 ,
        1.5055143 ,  1.330226  , -2.442145  , -0.18980293, -0.01817804,
        2.0299375 , -2.4045262 , -2.3225908 , -2.2508059 , -2.3757944 ,
       -2.3680203 ,  1.8227509 ,  1.426772  ,  1.5975726 ,  1.3518956 ,
        1.4468066 , -0.12838049, -2.38856   , -2.3948889 , -2.3946338 ,
       -2.1732583 , -2.48524   , -2.8634093 , -2.402962  , -2.4014635 ],
      dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 16:06:20 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 16:06:20 [    INFO]   Total events read: 30000 (physlite_feature_processor.py:1404)
2025-06-27 16:06:20 [    INFO]   Events passing selection (incl. derived calc): 29817 (physlite_feature_processor.py:1405)
2025-06-27 16:06:20 [    INFO]   Processing time: 24.08s (physlite_feature_processor.py:1408)
2025-06-27 16:06:20 [    INFO]   Rate: 1245.9 events/s (physlite_feature_processor.py:1409)
2025-06-27 16:06:20 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_tt_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 16:06:20 [    INFO] Loaded bin edges metadata from /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:2014)
2025-06-27 16:06:20 [    INFO] Feature 'N_Tracks_per_Event': 0 values (0.0%) below bin range, 124 values (2.5%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Feature 'Track d0': 9 values (0.0%) below bin range, 6 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Feature 'Track z0': 714 values (0.5%) below bin range, 469 values (0.3%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Feature 'Track phi': 91 values (0.1%) below bin range, 133 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Feature 'Track Eta': 39 values (0.0%) below bin range, 69 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Feature 'Track pT': 21 values (0.0%) below bin range, 2765 values (1.9%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Feature 'Track Reduced Chi2': 150 values (0.1%) below bin range, 88 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:20 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/zprime_tt_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 16:06:20 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 16:06:22 [    INFO] [Debug] Processing signal type: zprime_bb (dataset_manager.py:501)
2025-06-27 16:06:22 [    INFO] [Debug] plot_output for signal JSON data naming: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_bb_dataset_features.png (dataset_manager.py:516)
2025-06-27 16:06:22 [    INFO] Processing signal data for zprime_bb (physlite_feature_processor.py:1001)
2025-06-27 16:06:22 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 16:06:22 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 16:06:22 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 16:06:22 [    INFO] [debug] Initially required branches (incl. derived): {'InDetTrackParticlesAuxDyn.z0', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'MET_Core_AnalysisMETAuxDyn.mpy', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.pt', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1033)
2025-06-27 16:06:22 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1061)
2025-06-27 16:06:22 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF'} (physlite_feature_processor.py:1064)
2025-06-27 16:06:22 [    INFO] Actual branches to read from file: {'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.numberDoF', 'MET_Core_AnalysisMETAuxDyn.mpy', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.theta', 'InDetTrackParticlesAuxDyn.d0', 'InDetTrackParticlesAuxDyn.chiSquared', 'MET_Core_AnalysisMETAuxDyn.mpx', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi'} (physlite_feature_processor.py:1067)
2025-06-27 16:06:22 [    INFO] Getting catalog paths for run None and signal zprime_bb (physlite_feature_processor.py:1079)
2025-06-27 16:06:22 [    INFO] Found 1 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 16:06:22 [    INFO] Plotting enabled. Aiming for ~5000 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 16:06:22 [    INFO] Processing catalog 1/1 with path: atlas_data/signal_catalogs/zprime_bb_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 16:06:30 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 16:06:30 [    INFO]   Total events read: 10000 (physlite_feature_processor.py:1404)
2025-06-27 16:06:30 [    INFO]   Events passing selection (incl. derived calc): 9752 (physlite_feature_processor.py:1405)
2025-06-27 16:06:30 [    INFO]   Processing time: 7.38s (physlite_feature_processor.py:1408)
2025-06-27 16:06:30 [    INFO]   Rate: 1354.3 events/s (physlite_feature_processor.py:1409)
2025-06-27 16:06:30 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_bb_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 16:06:30 [    INFO] Loaded bin edges metadata from /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:2014)
2025-06-27 16:06:30 [    INFO] Feature 'N_Tracks_per_Event': 0 values (0.0%) below bin range, 38 values (0.8%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Feature 'Track d0': 15 values (0.0%) below bin range, 2 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Feature 'Track z0': 641 values (0.4%) below bin range, 415 values (0.3%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Feature 'Track phi': 116 values (0.1%) below bin range, 139 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Feature 'Track Eta': 35 values (0.0%) below bin range, 48 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Feature 'Track pT': 17 values (0.0%) below bin range, 2759 values (1.9%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Feature 'Track Reduced Chi2': 145 values (0.1%) below bin range, 125 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 16:06:30 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/zprime_bb_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 16:06:30 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 16:06:31 [    INFO] Creating combined input feature distribution comparison plot for background vs. signals. (dataset_manager.py:693)
2025-06-27 16:06:31 [    INFO] Creating plot from 3 data file(s) to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/comparison_input_features_background_vs_signals.png (dataset_visualizer.py:108)
2025-06-27 16:06:35 [    INFO] Successfully created plot and saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/comparison_input_features_background_vs_signals.png (dataset_visualizer.py:283)
2025-06-27 16:06:35 [    INFO] Saved combined comparison plot to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/comparison_input_features_background_vs_signals.png (dataset_manager.py:723)
2025-06-27 16:06:36 [    INFO] Successfully loaded 2 signal datasets (dataset_manager.py:934)
2025-06-27 16:06:36 [    INFO] Creating balanced labeled datasets... (foundation_model_pipeline.py:1466)
2025-06-27 16:06:37 [    INFO] Total training events available: 66320 (foundation_model_pipeline.py:1506)
2025-06-27 16:06:37 [    INFO] Data sizes to test: [1000, 2000] (foundation_model_pipeline.py:1514)
2025-06-27 16:06:37 [    INFO] Loading foundation model configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:1517)
2025-06-27 16:06:37 [    INFO] Loading pre-trained deterministic encoder from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/deterministic_encoder (foundation_model_pipeline.py:1560)
2025-06-27 16:06:38 [ WARNING] No training configuration found in save file, so the model was *not* compiled. Compile it manually. (load.py:178)
2025-06-27 16:06:38 [    INFO] Loaded deterministic encoder with output shape: (None, 2) (foundation_model_pipeline.py:1567)
2025-06-27 16:06:38 [    INFO]
================================================== (foundation_model_pipeline.py:1667)
2025-06-27 16:06:38 [    INFO] Training with 1000 events (foundation_model_pipeline.py:1668)
2025-06-27 16:06:38 [    INFO] ================================================== (foundation_model_pipeline.py:1669)
2025-06-27 16:06:38 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1675)
2025-06-27 16:06:38 [    INFO] Training From_Scratch model with 1000 events... (foundation_model_pipeline.py:1613)
2025-06-27 16:06:38 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:06:38 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:06:38 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:06:39 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:06:39 [    INFO]   Features: (1000, 180) (model_trainer.py:288)
2025-06-27 16:06:39 [    INFO]   Targets: (1000,) (model_trainer.py:289)
2025-06-27 16:06:39 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:06:39 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:06:41 [    INFO] Epoch 1/3 completed in 1.9s - loss: 3.527994 - binary_accuracy: 0.532000 - precision: 0.000000 - recall: 0.000000 - val_loss: 11.665338 - val_binary_accuracy: 0.132697 - val_precision: 0.000000 - val_recall: 0.000000 (model_trainer.py:37)
2025-06-27 16:06:41 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:06:42 [    INFO] Epoch 2/3 completed in 1.7s - loss: 3.711559 - binary_accuracy: 0.522000 - precision: 0.000000 - recall: 0.000000 - val_loss: 11.676891 - val_binary_accuracy: 0.132697 - val_precision: 0.000000 - val_recall: 0.000000 (model_trainer.py:37)
2025-06-27 16:06:42 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:06:44 [    INFO] Epoch 3/3 completed in 1.6s - loss: 4.112821 - binary_accuracy: 0.532000 - precision: 0.000000 - recall: 0.000000 - val_loss: 11.666777 - val_binary_accuracy: 0.132697 - val_precision: 0.000000 - val_recall: 0.000000 (model_trainer.py:37)
2025-06-27 16:06:44 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:06:44 [    INFO]   loss: 4.112821 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   binary_accuracy: 0.532000 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   precision: 0.000000 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   recall: 0.000000 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   val_loss: 11.666777 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   val_binary_accuracy: 0.132697 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   val_precision: 0.000000 (model_trainer.py:329)
2025-06-27 16:06:44 [    INFO]   val_recall: 0.000000 (model_trainer.py:329)
2025-06-27 16:06:45 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:06:45 [    INFO]   test_loss: 11.666451 (model_trainer.py:595)
2025-06-27 16:06:45 [    INFO]   test_binary_accuracy: 0.132723 (model_trainer.py:595)
2025-06-27 16:06:45 [    INFO]   test_precision: 0.000000 (model_trainer.py:595)
2025-06-27 16:06:45 [    INFO]   test_recall: 0.000000 (model_trainer.py:595)
2025-06-27 16:06:45 [    INFO] From_Scratch with 1000 events - Test Loss: 11.666451, Test Accuracy: 0.132723 (foundation_model_pipeline.py:1649)
2025-06-27 16:06:45 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1708)
2025-06-27 16:06:46 [    INFO] Training Fine_Tuned model with 1000 events... (foundation_model_pipeline.py:1613)
2025-06-27 16:06:46 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:06:46 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:06:46 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:06:46 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:06:46 [    INFO]   Features: (1000, 180) (model_trainer.py:288)
2025-06-27 16:06:46 [    INFO]   Targets: (1000,) (model_trainer.py:289)
2025-06-27 16:06:46 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:06:46 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:06:48 [    INFO] Epoch 1/3 completed in 2.3s - loss: 6.743481 - binary_accuracy: 0.467000 - precision_1: 0.000000 - recall_1: 0.000000 - val_loss: 13.039277 - val_binary_accuracy: 0.104279 - val_precision_1: 0.330087 - val_recall_1: 0.031827 (model_trainer.py:37)
2025-06-27 16:06:48 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:06:50 [    INFO] Epoch 2/3 completed in 1.9s - loss: 6.465032 - binary_accuracy: 0.491000 - precision_1: 0.000000 - recall_1: 0.000000 - val_loss: 13.043000 - val_binary_accuracy: 0.104075 - val_precision_1: 0.327489 - val_recall_1: 0.031324 (model_trainer.py:37)
2025-06-27 16:06:50 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:06:52 [    INFO] Epoch 3/3 completed in 1.9s - loss: 6.580878 - binary_accuracy: 0.479000 - precision_1: 0.000000 - recall_1: 0.000000 - val_loss: 13.045491 - val_binary_accuracy: 0.104308 - val_precision_1: 0.328411 - val_recall_1: 0.031324 (model_trainer.py:37)
2025-06-27 16:06:52 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:06:52 [    INFO]   loss: 6.580878 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   binary_accuracy: 0.479000 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   precision_1: 0.000000 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   recall_1: 0.000000 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   val_loss: 13.045491 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   val_binary_accuracy: 0.104308 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   val_precision_1: 0.328411 (model_trainer.py:329)
2025-06-27 16:06:52 [    INFO]   val_recall_1: 0.031324 (model_trainer.py:329)
2025-06-27 16:06:54 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:06:54 [    INFO]   test_loss: 13.037889 (model_trainer.py:595)
2025-06-27 16:06:54 [    INFO]   test_binary_accuracy: 0.104945 (model_trainer.py:595)
2025-06-27 16:06:54 [    INFO]   test_precision_1: 0.330854 (model_trainer.py:595)
2025-06-27 16:06:54 [    INFO]   test_recall_1: 0.031324 (model_trainer.py:595)
2025-06-27 16:06:54 [    INFO] Fine_Tuned with 1000 events - Test Loss: 13.037889, Test Accuracy: 0.104945 (foundation_model_pipeline.py:1649)
2025-06-27 16:06:54 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1740)
2025-06-27 16:06:54 [    INFO] Training Fixed_Encoder model with 1000 events... (foundation_model_pipeline.py:1613)
2025-06-27 16:06:54 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:06:54 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:06:54 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:06:54 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:06:54 [    INFO]   Features: (1000, 180) (model_trainer.py:288)
2025-06-27 16:06:54 [    INFO]   Targets: (1000,) (model_trainer.py:289)
2025-06-27 16:06:54 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:06:55 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:06:56 [    INFO] Epoch 1/3 completed in 1.9s - loss: 1.526319 - binary_accuracy: 0.836000 - precision_2: 0.000000 - recall_2: 0.000000 - val_loss: 1.316125 - val_binary_accuracy: 0.211350 - val_precision_2: 0.900474 - val_recall_2: 0.101955 (model_trainer.py:37)
2025-06-27 16:06:56 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:06:58 [    INFO] Epoch 2/3 completed in 1.8s - loss: 1.447411 - binary_accuracy: 0.821000 - precision_2: 0.000000 - recall_2: 0.000000 - val_loss: 1.344079 - val_binary_accuracy: 0.194305 - val_precision_2: 0.895444 - val_recall_2: 0.080424 (model_trainer.py:37)
2025-06-27 16:06:58 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:07:00 [    INFO] Epoch 3/3 completed in 1.8s - loss: 1.459124 - binary_accuracy: 0.822000 - precision_2: 0.000000 - recall_2: 0.000000 - val_loss: 1.359044 - val_binary_accuracy: 0.189854 - val_precision_2: 0.896329 - val_recall_2: 0.074521 (model_trainer.py:37)
2025-06-27 16:07:00 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:07:00 [    INFO]   loss: 1.459124 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   binary_accuracy: 0.822000 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   precision_2: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   recall_2: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   val_loss: 1.359044 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   val_binary_accuracy: 0.189854 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   val_precision_2: 0.896329 (model_trainer.py:329)
2025-06-27 16:07:00 [    INFO]   val_recall_2: 0.074521 (model_trainer.py:329)
2025-06-27 16:07:02 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:07:02 [    INFO]   test_loss: 1.367929 (model_trainer.py:595)
2025-06-27 16:07:02 [    INFO]   test_binary_accuracy: 0.189471 (model_trainer.py:595)
2025-06-27 16:07:02 [    INFO]   test_precision_2: 0.891296 (model_trainer.py:595)
2025-06-27 16:07:02 [    INFO]   test_recall_2: 0.074521 (model_trainer.py:595)
2025-06-27 16:07:02 [    INFO] Fixed_Encoder with 1000 events - Test Loss: 1.367929, Test Accuracy: 0.189471 (foundation_model_pipeline.py:1649)
2025-06-27 16:07:02 [    INFO]
================================================== (foundation_model_pipeline.py:1667)
2025-06-27 16:07:02 [    INFO] Training with 2000 events (foundation_model_pipeline.py:1668)
2025-06-27 16:07:02 [    INFO] ================================================== (foundation_model_pipeline.py:1669)
2025-06-27 16:07:02 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1675)
2025-06-27 16:07:02 [    INFO] Training From_Scratch model with 2000 events... (foundation_model_pipeline.py:1613)
2025-06-27 16:07:02 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:07:02 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:07:02 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:07:02 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:07:02 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:07:02 [    INFO]   Targets: (1024,) (model_trainer.py:289)
2025-06-27 16:07:02 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:07:02 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:07:04 [    INFO] Epoch 1/3 completed in 1.8s - loss: 3.508971 - binary_accuracy: 0.696500 - precision_3: 0.000000 - recall_3: 0.000000 - val_loss: 4.784954 - val_binary_accuracy: 0.337619 - val_precision_3: 0.847010 - val_recall_3: 0.288359 (model_trainer.py:37)
2025-06-27 16:07:04 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:07:06 [    INFO] Epoch 2/3 completed in 1.7s - loss: 3.525890 - binary_accuracy: 0.710500 - precision_3: 0.000000 - recall_3: 0.000000 - val_loss: 4.939052 - val_binary_accuracy: 0.330231 - val_precision_3: 0.853882 - val_recall_3: 0.274776 (model_trainer.py:37)
2025-06-27 16:07:06 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:07:08 [    INFO] Epoch 3/3 completed in 1.7s - loss: 3.035015 - binary_accuracy: 0.749500 - precision_3: 0.000000 - recall_3: 0.000000 - val_loss: 5.031239 - val_binary_accuracy: 0.321097 - val_precision_3: 0.860274 - val_recall_3: 0.259349 (model_trainer.py:37)
2025-06-27 16:07:08 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:07:08 [    INFO]   loss: 3.035015 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   binary_accuracy: 0.749500 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   precision_3: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   recall_3: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   val_loss: 5.031239 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   val_binary_accuracy: 0.321097 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   val_precision_3: 0.860274 (model_trainer.py:329)
2025-06-27 16:07:08 [    INFO]   val_recall_3: 0.259349 (model_trainer.py:329)
2025-06-27 16:07:09 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:07:09 [    INFO]   test_loss: 5.032645 (model_trainer.py:595)
2025-06-27 16:07:09 [    INFO]   test_binary_accuracy: 0.323211 (model_trainer.py:595)
2025-06-27 16:07:09 [    INFO]   test_precision_3: 0.867220 (model_trainer.py:595)
2025-06-27 16:07:09 [    INFO]   test_recall_3: 0.259349 (model_trainer.py:595)
2025-06-27 16:07:09 [    INFO] From_Scratch with 2000 events - Test Loss: 5.032645, Test Accuracy: 0.323211 (foundation_model_pipeline.py:1649)
2025-06-27 16:07:09 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1708)
2025-06-27 16:07:09 [    INFO] Training Fine_Tuned model with 2000 events... (foundation_model_pipeline.py:1613)
2025-06-27 16:07:09 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:07:09 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:07:09 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:07:10 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:07:10 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:07:10 [    INFO]   Targets: (1024,) (model_trainer.py:289)
2025-06-27 16:07:10 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:07:10 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:07:12 [    INFO] Epoch 1/3 completed in 1.9s - loss: 1.609060 - binary_accuracy: 0.808000 - precision_4: 0.000000 - recall_4: 0.000000 - val_loss: 13.354987 - val_binary_accuracy: 0.132697 - val_precision_4: 0.000000 - val_recall_4: 0.000000 (model_trainer.py:37)
2025-06-27 16:07:12 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:07:13 [    INFO] Epoch 2/3 completed in 1.8s - loss: 1.558456 - binary_accuracy: 0.810000 - precision_4: 0.000000 - recall_4: 0.000000 - val_loss: 13.347790 - val_binary_accuracy: 0.132697 - val_precision_4: 0.000000 - val_recall_4: 0.000000 (model_trainer.py:37)
2025-06-27 16:07:13 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:07:15 [    INFO] Epoch 3/3 completed in 1.8s - loss: 1.429425 - binary_accuracy: 0.817500 - precision_4: 0.000000 - recall_4: 0.000000 - val_loss: 13.344636 - val_binary_accuracy: 0.132697 - val_precision_4: 0.000000 - val_recall_4: 0.000000 (model_trainer.py:37)
2025-06-27 16:07:15 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:07:15 [    INFO]   loss: 1.429425 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   binary_accuracy: 0.817500 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   precision_4: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   recall_4: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   val_loss: 13.344636 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   val_binary_accuracy: 0.132697 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   val_precision_4: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:15 [    INFO]   val_recall_4: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:17 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:07:17 [    INFO]   test_loss: 13.344250 (model_trainer.py:595)
2025-06-27 16:07:17 [    INFO]   test_binary_accuracy: 0.132723 (model_trainer.py:595)
2025-06-27 16:07:17 [    INFO]   test_precision_4: 0.000000 (model_trainer.py:595)
2025-06-27 16:07:17 [    INFO]   test_recall_4: 0.000000 (model_trainer.py:595)
2025-06-27 16:07:17 [    INFO] Fine_Tuned with 2000 events - Test Loss: 13.344250, Test Accuracy: 0.132723 (foundation_model_pipeline.py:1649)
2025-06-27 16:07:17 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1740)
2025-06-27 16:07:17 [    INFO] Training Fixed_Encoder model with 2000 events... (foundation_model_pipeline.py:1613)
2025-06-27 16:07:17 [    INFO] Starting training with metrics tracking: (model_trainer.py:259)
2025-06-27 16:07:17 [    INFO] Preparing datasets for training... (model_trainer.py:274)
2025-06-27 16:07:17 [    INFO] Training dataset batches: -2 (model_trainer.py:284)
2025-06-27 16:07:18 [    INFO] Training dataset batch shapes: (model_trainer.py:287)
2025-06-27 16:07:18 [    INFO]   Features: (1024, 180) (model_trainer.py:288)
2025-06-27 16:07:18 [    INFO]   Targets: (1024,) (model_trainer.py:289)
2025-06-27 16:07:18 [    INFO] Starting training for 3 epochs (model_trainer.py:28)
2025-06-27 16:07:18 [    INFO] Starting epoch 1/3 (model_trainer.py:32)
2025-06-27 16:07:20 [    INFO] Epoch 1/3 completed in 2.0s - loss: 1.331567 - binary_accuracy: 0.766000 - precision_5: 0.000000 - recall_5: 0.000000 - val_loss: 1.455664 - val_binary_accuracy: 0.392100 - val_precision_5: 0.916651 - val_recall_5: 0.329007 (model_trainer.py:37)
2025-06-27 16:07:20 [    INFO] Starting epoch 2/3 (model_trainer.py:32)
2025-06-27 16:07:21 [    INFO] Epoch 2/3 completed in 1.7s - loss: 1.244444 - binary_accuracy: 0.777500 - precision_5: 0.000000 - recall_5: 0.000000 - val_loss: 1.548432 - val_binary_accuracy: 0.308095 - val_precision_5: 0.916897 - val_recall_5: 0.222390 (model_trainer.py:37)
2025-06-27 16:07:21 [    INFO] Starting epoch 3/3 (model_trainer.py:32)
2025-06-27 16:07:23 [    INFO] Epoch 3/3 completed in 1.8s - loss: 1.193511 - binary_accuracy: 0.789500 - precision_5: 0.000000 - recall_5: 0.000000 - val_loss: 1.603217 - val_binary_accuracy: 0.140231 - val_precision_5: 0.850949 - val_recall_5: 0.010531 (model_trainer.py:37)
2025-06-27 16:07:23 [    INFO] Training completed. Final metrics: (model_trainer.py:327)
2025-06-27 16:07:23 [    INFO]   loss: 1.193511 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   binary_accuracy: 0.789500 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   precision_5: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   recall_5: 0.000000 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   val_loss: 1.603217 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   val_binary_accuracy: 0.140231 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   val_precision_5: 0.850949 (model_trainer.py:329)
2025-06-27 16:07:23 [    INFO]   val_recall_5: 0.010531 (model_trainer.py:329)
2025-06-27 16:07:25 [    INFO] Evaluation metrics: (model_trainer.py:593)
2025-06-27 16:07:25 [    INFO]   test_loss: 1.604029 (model_trainer.py:595)
2025-06-27 16:07:25 [    INFO]   test_binary_accuracy: 0.139849 (model_trainer.py:595)
2025-06-27 16:07:25 [    INFO]   test_precision_5: 0.819843 (model_trainer.py:595)
2025-06-27 16:07:25 [    INFO]   test_recall_5: 0.010531 (model_trainer.py:595)
2025-06-27 16:07:25 [    INFO] Fixed_Encoder with 2000 events - Test Loss: 1.604029, Test Accuracy: 0.139849 (foundation_model_pipeline.py:1649)
2025-06-27 16:07:25 [    INFO] Creating data efficiency plots... (foundation_model_pipeline.py:1772)
2025-06-27 16:07:25 [    INFO] Results saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/signal_classification/signal_classification_data_efficiency_results.json (foundation_model_pipeline.py:1781)
2025-06-27 16:07:27 [    INFO] Loss plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/signal_classification/signal_classification_loss_plot.png (foundation_model_pipeline.py:1895)
2025-06-27 16:07:27 [    INFO] Accuracy plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/signal_classification/signal_classification_accuracy_plot.png (foundation_model_pipeline.py:1896)
2025-06-27 16:07:27 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1902)
2025-06-27 16:07:27 [    INFO] Signal Classification Evaluation Results Summary (foundation_model_pipeline.py:1903)
2025-06-27 16:07:27 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1904)
2025-06-27 16:07:27 [    INFO] Signal Dataset: zprime_tt (foundation_model_pipeline.py:1905)
2025-06-27 16:07:27 [    INFO] Training Events: 1000 (foundation_model_pipeline.py:1908)
2025-06-27 16:07:27 [    INFO]   From Scratch:  Loss: 11.666451, Accuracy: 0.132723 (foundation_model_pipeline.py:1909)
2025-06-27 16:07:27 [    INFO]   Fine-Tuned:    Loss: 13.037889, Accuracy: 0.104945 (foundation_model_pipeline.py:1912)
2025-06-27 16:07:27 [    INFO]   Fixed Encoder: Loss: 1.367929, Accuracy: 0.189471 (foundation_model_pipeline.py:1915)
2025-06-27 16:07:27 [    INFO]   Fine-Tuned accuracy improvement: -3.2% (foundation_model_pipeline.py:1932)
2025-06-27 16:07:27 [    INFO]   Fixed accuracy improvement: 6.5% (foundation_model_pipeline.py:1935)
2025-06-27 16:07:27 [    INFO]  (foundation_model_pipeline.py:1938)
2025-06-27 16:07:27 [    INFO] Training Events: 2000 (foundation_model_pipeline.py:1908)
2025-06-27 16:07:27 [    INFO]   From Scratch:  Loss: 5.032645, Accuracy: 0.323211 (foundation_model_pipeline.py:1909)
2025-06-27 16:07:27 [    INFO]   Fine-Tuned:    Loss: 13.344250, Accuracy: 0.132723 (foundation_model_pipeline.py:1912)
2025-06-27 16:07:27 [    INFO]   Fixed Encoder: Loss: 1.604029, Accuracy: 0.139849 (foundation_model_pipeline.py:1915)
2025-06-27 16:07:27 [    INFO]   Fine-Tuned accuracy improvement: -28.1% (foundation_model_pipeline.py:1932)
2025-06-27 16:07:27 [    INFO]   Fixed accuracy improvement: -27.1% (foundation_model_pipeline.py:1935)
2025-06-27 16:07:27 [    INFO]  (foundation_model_pipeline.py:1938)
2025-06-27 16:07:27 [    INFO] Signal classification evaluation completed successfully (foundation_model_pipeline.py:1940)
2025-06-27 16:07:27 [    INFO] Signal classification evaluation completed successfully (foundation_model_pipeline.py:295)
2025-06-27 16:07:27 [    INFO]
================================================== (foundation_model_pipeline.py:298)
2025-06-27 16:07:27 [    INFO] STEP 4/4: ANOMALY DETECTION EVALUATION (foundation_model_pipeline.py:299)
2025-06-27 16:07:27 [    INFO] ================================================== (foundation_model_pipeline.py:300)
2025-06-27 16:07:27 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:655)
2025-06-27 16:07:27 [    INFO] Evaluating Foundation Model for Anomaly Detection (foundation_model_pipeline.py:656)
2025-06-27 16:07:27 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:657)
2025-06-27 16:07:27 [    INFO] ModelRegistry paths: (model_registry.py:27)
2025-06-27 16:07:27 [    INFO] Base path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments (model_registry.py:28)
2025-06-27 16:07:27 [    INFO] DB path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (model_registry.py:29)
2025-06-27 16:07:27 [    INFO] Registry initialized at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (foundation_model_pipeline.py:689)
2025-06-27 16:07:27 [    INFO] Loading original model config from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/_experiment_config.yaml (foundation_model_pipeline.py:692)
2025-06-27 16:07:27 [    INFO] Initializing Dataset Manager... (foundation_model_pipeline.py:721)
2025-06-27 16:07:27 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 16:07:27 [    INFO] Using batch size from provided VAE training config: 1024 (foundation_model_pipeline.py:729)
2025-06-27 16:07:27 [    INFO] Loading background (test) dataset... (foundation_model_pipeline.py:740)
2025-06-27 16:07:27 [    INFO] Loading datasets (dataset_manager.py:802)
2025-06-27 16:07:27 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:07:27 [    INFO] Loaded background (test) dataset. (foundation_model_pipeline.py:751)
2025-06-27 16:07:27 [    INFO] Reloading signal datasets for evaluation and comparison plotting... (foundation_model_pipeline.py:782)
2025-06-27 16:07:27 [    INFO] Loading signal datasets (dataset_manager.py:883)
2025-06-27 16:07:27 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:142)
2025-06-27 16:07:28 [    INFO] Successfully loaded 2 signal datasets (dataset_manager.py:934)
2025-06-27 16:07:28 [    INFO] Reloaded 2 signal datasets for evaluation. (foundation_model_pipeline.py:791)
2025-06-27 16:07:28 [    INFO] Instantiating VAE model from loaded configuration... (foundation_model_pipeline.py:801)
2025-06-27 16:07:28 [ WARNING] Input shape missing in loaded model config, deriving from task_config. (foundation_model_pipeline.py:805)
2025-06-27 16:07:28 [    INFO] Built encoder layers (variational_autoencoder.py:283)
2025-06-27 16:07:28 [    INFO] Built encoder model (variational_autoencoder.py:310)
2025-06-27 16:07:28 [    INFO] Built deterministic encoder model (variational_autoencoder.py:316)
2025-06-27 16:07:28 [    INFO] Built decoder layers (variational_autoencoder.py:341)
2025-06-27 16:07:28 [    INFO] Built decoder model (variational_autoencoder.py:358)
2025-06-27 16:07:29 [    INFO] Completed VAE architecture build (variational_autoencoder.py:369)
2025-06-27 16:07:29 [    INFO] Loading model weights from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/full_model (foundation_model_pipeline.py:842)
2025-06-27 16:07:29 [    INFO] VAE model loaded successfully. (foundation_model_pipeline.py:845)
2025-06-27 16:07:29 [    INFO] None (foundation_model_pipeline.py:846)
2025-06-27 16:07:29 [    INFO] Running anomaly detection evaluation... (foundation_model_pipeline.py:852)
2025-06-27 16:07:29 [    INFO] Running anomaly detection test... (variational_autoencoder.py:1139)
2025-06-27 16:07:29 [    INFO] Dataset information before testing: (variational_autoencoder.py:1149)
2025-06-27 16:07:29 [    INFO] Background test dataset batch shape: (1024, 180) (variational_autoencoder.py:1157)
2025-06-27 16:07:29 [    INFO] zprime_bb signal dataset batch shape: (1024, 180) (variational_autoencoder.py:1168)
2025-06-27 16:07:29 [    INFO] zprime_tt signal dataset batch shape: (1024, 180) (variational_autoencoder.py:1168)
2025-06-27 16:07:29 [    INFO] Calculating losses for background dataset... (variational_autoencoder.py:1174)
2025-06-27 16:07:29 [    INFO] Calculating losses for dataset... (variational_autoencoder.py:668)
2025-06-27 16:07:30 [    INFO] Dataset stats: (variational_autoencoder.py:716)
2025-06-27 16:07:30 [    INFO]   Total batches: 45 (variational_autoencoder.py:717)
2025-06-27 16:07:30 [    INFO]   Total events: 45628 (variational_autoencoder.py:718)
2025-06-27 16:07:30 [    INFO]   Events per batch: 1014.0 (variational_autoencoder.py:719)
2025-06-27 16:07:30 [    INFO] Calculating losses for signal dataset: zprime_bb (variational_autoencoder.py:1182)
2025-06-27 16:07:30 [    INFO] Calculating losses for dataset... (variational_autoencoder.py:668)
2025-06-27 16:07:31 [    INFO] Dataset stats: (variational_autoencoder.py:716)
2025-06-27 16:07:31 [    INFO]   Total batches: 10 (variational_autoencoder.py:717)
2025-06-27 16:07:31 [    INFO]   Total events: 9752 (variational_autoencoder.py:718)
2025-06-27 16:07:31 [    INFO]   Events per batch: 975.2 (variational_autoencoder.py:719)
2025-06-27 16:07:31 [    INFO] Calculating losses for signal dataset: zprime_tt (variational_autoencoder.py:1182)
2025-06-27 16:07:31 [    INFO] Calculating losses for dataset... (variational_autoencoder.py:668)
2025-06-27 16:07:32 [    INFO] Dataset stats: (variational_autoencoder.py:716)
2025-06-27 16:07:32 [    INFO]   Total batches: 30 (variational_autoencoder.py:717)
2025-06-27 16:07:32 [    INFO]   Total events: 29817 (variational_autoencoder.py:718)
2025-06-27 16:07:32 [    INFO]   Events per batch: 993.9 (variational_autoencoder.py:719)
2025-06-27 16:07:32 [    INFO] Creating combined loss distribution plots... (variational_autoencoder.py:945)
2025-06-27 16:07:32 [    INFO] Calculating global bin edges for coordinated loss distribution binning... (variational_autoencoder.py:954)
2025-06-27 16:07:32 [    INFO] Reconstruction loss bin range: [34.081, 3510.876] (covers 99.8% of all data) (variational_autoencoder.py:983)
2025-06-27 16:07:32 [    INFO] KL divergence loss bin range: [0.135, 19.773] (covers 99.8% of all data) (variational_autoencoder.py:986)
2025-06-27 16:07:32 [    INFO] Using coordinated bin edges to ensure perfect histogram alignment (variational_autoencoder.py:989)
2025-06-27 16:07:32 [    INFO] Saved loss bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_bin_edges_metadata.json (variational_autoencoder.py:1016)
2025-06-27 16:07:32 [    INFO] Saved reconstruction loss distribution data for background to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_background_reconstruction_data.json (variational_autoencoder.py:857)
2025-06-27 16:07:32 [    INFO] Saved kl_divergence loss distribution data for background to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_background_kl_divergence_data.json (variational_autoencoder.py:857)
2025-06-27 16:07:32 [    INFO] Saved reconstruction loss distribution data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_bb_reconstruction_data.json (variational_autoencoder.py:857)
2025-06-27 16:07:32 [    INFO] Saved kl_divergence loss distribution data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_bb_kl_divergence_data.json (variational_autoencoder.py:857)
2025-06-27 16:07:32 [    INFO] Saved reconstruction ROC curve data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_bb_reconstruction_data.json (variational_autoencoder.py:924)
2025-06-27 16:07:32 [    INFO] Saved kl_divergence ROC curve data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_bb_kl_divergence_data.json (variational_autoencoder.py:924)
2025-06-27 16:07:32 [    INFO] Saved reconstruction loss distribution data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_tt_reconstruction_data.json (variational_autoencoder.py:857)
2025-06-27 16:07:32 [    INFO] Saved kl_divergence loss distribution data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_tt_kl_divergence_data.json (variational_autoencoder.py:857)
2025-06-27 16:07:32 [    INFO] Saved reconstruction ROC curve data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_tt_reconstruction_data.json (variational_autoencoder.py:924)
2025-06-27 16:07:32 [    INFO] Saved kl_divergence ROC curve data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_tt_kl_divergence_data.json (variational_autoencoder.py:924)
2025-06-27 16:07:32 [    INFO] Creating combined two-panel loss distribution plot from 3 dataset(s) to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_loss_distributions.png (dataset_visualizer.py:404)
2025-06-27 16:07:34 [    INFO] Successfully created combined two-panel loss distribution plot and saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_loss_distributions.png (dataset_visualizer.py:505)
2025-06-27 16:07:34 [    INFO] Saved combined two-panel loss distribution plot to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_loss_distributions.png (variational_autoencoder.py:1091)
2025-06-27 16:07:34 [    INFO] Creating combined two-panel ROC curves plot from 2 dataset(s) to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_roc_curves.png (dataset_visualizer.py:633)
2025-06-27 16:07:35 [    INFO] Successfully created combined two-panel ROC curves plot and saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_roc_curves.png (dataset_visualizer.py:721)
2025-06-27 16:07:35 [    INFO] Saved combined ROC curves plot to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_roc_curves.png (variational_autoencoder.py:1118)
2025-06-27 16:07:35 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:867)
2025-06-27 16:07:35 [    INFO] Anomaly Detection Results (foundation_model_pipeline.py:868)
2025-06-27 16:07:35 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:869)
2025-06-27 16:07:35 [    INFO] Foundation Model ID: 001_Foundation_VAE_Model (foundation_model_pipeline.py:871)
2025-06-27 16:07:35 [    INFO] Anomaly detection evaluation completed. Results are available in the testing directory. (foundation_model_pipeline.py:872)
2025-06-27 16:07:35 [    INFO] Anomaly detection evaluation completed successfully (foundation_model_pipeline.py:876)
2025-06-27 16:07:35 [    INFO] Anomaly detection evaluation completed successfully (foundation_model_pipeline.py:315)
2025-06-27 16:07:35 [    INFO]
==================================================================================================== (foundation_model_pipeline.py:318)
2025-06-27 16:07:35 [    INFO] FULL PIPELINE COMPLETED SUCCESSFULLY (foundation_model_pipeline.py:319)
2025-06-27 16:07:35 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:320)
2025-06-27 16:07:35 [    INFO] Foundation model: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:321)
2025-06-27 16:07:35 [    INFO] All four processes (train → regression → signal classification → anomaly) completed successfully (foundation_model_pipeline.py:322)
2025-06-27 16:07:35 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:325)
2025-06-27 16:07:35 [    INFO] Full pipeline test completed successfully. Model saved at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (test_pipeline.py:214)
PASSED                                                                   [100%]

=============================== warnings summary ===============================
../../../../../../../../sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:65
  /sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:65: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if (distutils.version.LooseVersion(tf.version.VERSION) <

../../../../../../../../sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:66
  /sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:66: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    distutils.version.LooseVersion(required_tensorflow_version)):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================== 1 passed, 2 warnings in 242.46s (0:04:02) ===================
