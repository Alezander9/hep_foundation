============================= test session starts ==============================
platform linux -- Python 3.9.21, pytest-8.3.5, pluggy-1.5.0 -- /sdf/home/a/alexyue/miniconda3/envs/hep_foundation/bin/python3
cachedir: .pytest_cache
rootdir: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation
configfile: pytest.ini
plugins: cov-6.1.1
collecting ... collected 1 item

tests/test_pipeline.py::test_run_full_pipeline
-------------------------------- live log setup --------------------------------
2025-06-27 14:15:02 [    INFO] Foundation Model Pipeline initialized. (foundation_model_pipeline.py:69)
2025-06-27 14:15:02 [    INFO]   Experiment outputs will be in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments (foundation_model_pipeline.py:70)
2025-06-27 14:15:02 [    INFO]   Processed datasets will be in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets (foundation_model_pipeline.py:73)
2025-06-27 14:15:02 [    INFO] TensorFlow: 2.13.1 (Eager: True) (foundation_model_pipeline.py:76)
2025-06-27 14:15:02 [    INFO] Loading configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/tests/_test_pipeline_config.yaml (config_loader.py:60)
2025-06-27 14:15:02 [    INFO] Creating configuration objects... (config_loader.py:118)
2025-06-27 14:15:02 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.eta' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 14:15:02 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.pt' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 14:15:02 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
-------------------------------- live log call ---------------------------------
2025-06-27 14:15:02 [    INFO] Starting full pipeline test (test_pipeline.py:111)
2025-06-27 14:15:02 [    INFO] Loading configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/tests/_test_pipeline_config.yaml (config_loader.py:60)
2025-06-27 14:15:02 [    INFO] Creating configuration objects... (config_loader.py:118)
2025-06-27 14:15:02 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.eta' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 14:15:02 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.pt' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 14:15:02 [    INFO] [debug] Branch 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared' identified as derived: type=BranchType.FEATURE_ARRAY, info={'shape': [2], 'dtype': 'float32', 'status': 'derived'} (physlite_utilities.py:77)
2025-06-27 14:15:02 [    INFO] Source config file set to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/tests/_test_pipeline_config.yaml (foundation_model_pipeline.py:88)
2025-06-27 14:15:02 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:219)
2025-06-27 14:15:02 [    INFO] RUNNING FULL FOUNDATION MODEL PIPELINE (foundation_model_pipeline.py:220)
2025-06-27 14:15:02 [    INFO] Process: Train → Regression → Signal Classification → Anomaly Detection (foundation_model_pipeline.py:221)
2025-06-27 14:15:02 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:222)
2025-06-27 14:15:02 [    INFO]
================================================== (foundation_model_pipeline.py:226)
2025-06-27 14:15:02 [    INFO] STEP 1/4: TRAINING FOUNDATION MODEL (foundation_model_pipeline.py:227)
2025-06-27 14:15:02 [    INFO] ================================================== (foundation_model_pipeline.py:228)
2025-06-27 14:15:02 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:346)
2025-06-27 14:15:02 [    INFO] Training Foundation Model (foundation_model_pipeline.py:347)
2025-06-27 14:15:02 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:348)
2025-06-27 14:15:02 [    INFO] Signal keys to process: ['zprime_tt', 'zprime_bb'] (foundation_model_pipeline.py:353)
2025-06-27 14:15:02 [    INFO] ModelRegistry paths: (model_registry.py:27)
2025-06-27 14:15:02 [    INFO] Base path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments (model_registry.py:28)
2025-06-27 14:15:02 [    INFO] DB path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (model_registry.py:29)
2025-06-27 14:15:02 [    INFO] Registry initialized at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (foundation_model_pipeline.py:378)
2025-06-27 14:15:02 [    INFO] Initializing managers... (foundation_model_pipeline.py:381)
2025-06-27 14:15:02 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 14:15:02 [    INFO] Validated dataset config (foundation_model_pipeline.py:386)
2025-06-27 14:15:02 [    INFO] Validated training config (foundation_model_pipeline.py:389)
2025-06-27 14:15:02 [    INFO] Loading datasets... (foundation_model_pipeline.py:392)
2025-06-27 14:15:02 [    INFO] Loading ATLAS datasets... (foundation_model_pipeline.py:395)
2025-06-27 14:15:02 [    INFO] Loading datasets (dataset_manager.py:769)
2025-06-27 14:15:02 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:15:02 [    INFO] Creating new dataset (dataset_manager.py:221)
2025-06-27 14:15:02 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:15:02 [    INFO] Processing run 00298967 (dataset_manager.py:254)
2025-06-27 14:15:02 [    INFO] Processing ATLAS data for run 00298967 (physlite_feature_processor.py:1003)
2025-06-27 14:15:02 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 14:15:02 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 14:15:02 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 14:15:02 [    INFO] [debug] Initially required branches (incl. derived): {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1033)
2025-06-27 14:15:02 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta'} (physlite_feature_processor.py:1061)
2025-06-27 14:15:02 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1064)
2025-06-27 14:15:02 [    INFO] Actual branches to read from file: {'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1067)
2025-06-27 14:15:02 [    INFO] Getting catalog paths for run 00298967 and signal None (physlite_feature_processor.py:1079)
2025-06-27 14:15:02 [    INFO] Found 2 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 14:15:02 [    INFO] Plotting enabled. Aiming for ~2500 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 14:15:02 [    INFO] Processing catalog 1/2 with path: atlas_data/catalogs/Run_00298967_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 14:15:04 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'MET_Core_AnalysisMETAuxDyn.mpy': array([0., 0.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.z0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 14:15:04 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'MET_Core_AnalysisMETAuxDyn.mpy': array([0., 0.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.z0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 14:15:04 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'MET_Core_AnalysisMETAuxDyn.mpy': array([0., 0.], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.z0': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([0., 0.], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 14:15:05 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'MET_Core_AnalysisMETAuxDyn.mpy': array([2917.072, 9026.598], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([226113.88 ,  53718.094], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([-6.6143926e-05, -1.0783443e-04, -2.5288420e-04,  2.0579198e-04,
       -1.3872961e-04,  8.7678985e-05, -1.2646682e-04, -2.1160622e-04,
       -2.2116047e-04], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([15., 51., 54., 38., 42., 35., 43., 26., 31.], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([-0.7860747 , -2.1698403 ,  0.62683016, -1.770601  , -2.2839856 ,
       -1.7957953 , -2.2082472 ,  0.96130866,  0.19878747], dtype=float32), 'InDetTrackParticlesAuxDyn.z0': array([-16.916328, -32.308327,  58.49811 , -32.18765 , -32.10135 ,
       -32.05595 , -32.095116, -31.947983,  10.947017], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([18.002485, 43.043682, 49.211033, 30.54344 , 43.093258, 39.571404,
       34.672108, 39.55346 , 26.473286], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([ 0.13263644, -0.02171086,  0.00573416, -0.04170312, -0.03904025,
       -0.02388315, -0.00572811, -0.0045231 , -0.01548618], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([3950.3628, 3931.1497], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([2.9713178 , 2.5829854 , 1.0149598 , 0.6786004 , 2.4676406 ,
       0.7737514 , 2.614008  , 0.85339445, 2.44664   ], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 14:15:05 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'MET_Core_AnalysisMETAuxDyn.mpy': array([ 4944.2974, -2786.3242], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([132987.1  ,  30587.148], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([ 7.3403731e-05,  3.1320455e-05, -1.2891174e-04, -9.1019674e-06,
        1.0585919e-04,  6.7659093e-05, -1.6294660e-04, -2.0465015e-04,
       -1.2586276e-04, -4.0642024e-04, -1.9996920e-04,  2.7437514e-04,
        2.8197269e-04, -1.7973114e-04], dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([21., 19., 26., 15., 38., 42., 43., 50., 22., 43., 41., 40., 10.,
       33.], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([-0.14381175, -0.16379137, -0.09652591, -0.05987956,  3.0106819 ,
        3.0062318 ,  3.0235908 ,  3.033448  , -1.8334734 ,  2.987984  ,
       -1.9293301 , -1.987573  ,  2.7328026 ,  0.3753599 ], dtype=float32), 'InDetTrackParticlesAuxDyn.z0': array([-55.209663, -55.129837, -55.110397, -54.956932, -55.164303,
       -55.039574, -55.226418, -55.239536, -55.117817, -55.1299  ,
       -55.064724, -55.08418 , -54.853413, -55.25521 ], dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([27.949524 , 17.56657  , 48.63797  ,  6.8980656, 20.873167 ,
       33.23165  , 33.20409  , 47.705704 , 12.156644 , 36.02148  ,
       26.540726 , 33.875515 , 24.180946 , 45.991604 ], dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([-0.05088669,  0.29357564, -0.03500424, -0.01277314, -0.02793986,
       -0.03660518,  0.00095294,  0.00965733, -0.01739617,  0.03437834,
        0.0255817 , -0.04874401,  0.0080739 , -0.12628022], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([ 5210.8325, -3313.4116], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([0.20400521, 0.20323035, 0.25270194, 0.21027593, 1.2624797 ,
       1.3421053 , 1.301371  , 1.371753  , 0.6967735 , 1.1996694 ,
       0.62363476, 0.56082845, 1.2570741 , 1.5608509 ], dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 14:15:21 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 14:15:21 [    INFO]   Total events read: 57629 (physlite_feature_processor.py:1404)
2025-06-27 14:15:21 [    INFO]   Events passing selection (incl. derived calc): 17630 (physlite_feature_processor.py:1405)
2025-06-27 14:15:21 [    INFO]   Processing time: 18.93s (physlite_feature_processor.py:1408)
2025-06-27 14:15:21 [    INFO]   Rate: 3045.0 events/s (physlite_feature_processor.py:1409)
2025-06-27 14:15:21 [    INFO] Processing catalog 2/2 with path: atlas_data/catalogs/Run_00298967_catalog_1.root (physlite_feature_processor.py:1120)
2025-06-27 14:15:41 [    INFO] Catalog 1 summary: (physlite_feature_processor.py:1403)
2025-06-27 14:15:41 [    INFO]   Total events read: 55732 (physlite_feature_processor.py:1404)
2025-06-27 14:15:41 [    INFO]   Events passing selection (incl. derived calc): 14477 (physlite_feature_processor.py:1405)
2025-06-27 14:15:41 [    INFO]   Processing time: 19.97s (physlite_feature_processor.py:1408)
2025-06-27 14:15:41 [    INFO]   Rate: 2790.3 events/s (physlite_feature_processor.py:1409)
2025-06-27 14:15:41 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/atlas_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 14:15:41 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/atlas_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 14:15:41 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 14:15:41 [    INFO] Processing run 00311481 (dataset_manager.py:254)
2025-06-27 14:15:41 [    INFO] Processing ATLAS data for run 00311481 (physlite_feature_processor.py:1003)
2025-06-27 14:15:41 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 14:15:41 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 14:15:41 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 14:15:41 [    INFO] [debug] Initially required branches (incl. derived): {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1033)
2025-06-27 14:15:41 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta'} (physlite_feature_processor.py:1061)
2025-06-27 14:15:41 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1064)
2025-06-27 14:15:41 [    INFO] Actual branches to read from file: {'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1067)
2025-06-27 14:15:41 [    INFO] Getting catalog paths for run 00311481 and signal None (physlite_feature_processor.py:1079)
2025-06-27 14:15:41 [    INFO] Found 2 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 14:15:41 [    INFO] Plotting enabled. Aiming for ~2500 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 14:15:41 [    INFO] Processing catalog 1/2 with path: atlas_data/catalogs/Run_00311481_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 14:15:50 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 14:15:50 [    INFO]   Total events read: 14689 (physlite_feature_processor.py:1404)
2025-06-27 14:15:50 [    INFO]   Events passing selection (incl. derived calc): 6750 (physlite_feature_processor.py:1405)
2025-06-27 14:15:50 [    INFO]   Processing time: 8.53s (physlite_feature_processor.py:1408)
2025-06-27 14:15:50 [    INFO]   Rate: 1722.4 events/s (physlite_feature_processor.py:1409)
2025-06-27 14:15:50 [    INFO] Processing catalog 2/2 with path: atlas_data/catalogs/Run_00311481_catalog_1.root (physlite_feature_processor.py:1120)
2025-06-27 14:15:56 [    INFO] Catalog 1 summary: (physlite_feature_processor.py:1403)
2025-06-27 14:15:56 [    INFO]   Total events read: 14722 (physlite_feature_processor.py:1404)
2025-06-27 14:15:56 [    INFO]   Events passing selection (incl. derived calc): 6771 (physlite_feature_processor.py:1405)
2025-06-27 14:15:56 [    INFO]   Processing time: 6.25s (physlite_feature_processor.py:1408)
2025-06-27 14:15:56 [    INFO]   Rate: 2355.4 events/s (physlite_feature_processor.py:1409)
2025-06-27 14:15:56 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/atlas_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 14:15:56 [    INFO] Loaded bin edges metadata from /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:2014)
2025-06-27 14:15:56 [    INFO] Feature 'N_Tracks_per_Event': 0 values (0.0%) below bin range, 2 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Feature 'Track d0': 135 values (0.1%) below bin range, 91 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Feature 'Track z0': 120 values (0.1%) below bin range, 191 values (0.2%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Feature 'Track phi': 116 values (0.1%) below bin range, 124 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Feature 'Track Eta': 110 values (0.1%) below bin range, 82 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Feature 'Track pT': 107 values (0.1%) below bin range, 166 values (0.2%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Feature 'Track Reduced Chi2': 102 values (0.1%) below bin range, 154 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:15:56 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/atlas_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 14:15:56 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 14:15:58 [    INFO] Generating labels datasets for 1 labels (dataset_manager.py:316)
2025-06-27 14:15:59 [    INFO] Saved dataset config to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_config.yaml (dataset_manager.py:172)
2025-06-27 14:15:59 [    INFO] Saved dataset info to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_info.json (dataset_manager.py:173)
2025-06-27 14:15:59 [    INFO] Saved configuration with processing stats to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_config.yaml and /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_info.json (dataset_manager.py:384)
2025-06-27 14:16:00 [    INFO] Created/loaded dataset with ID: dataset_runs_00298967-2-00311481_912fb71c (foundation_model_pipeline.py:408)
2025-06-27 14:16:00 [    INFO] Dataset file exists at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/dataset.h5 (foundation_model_pipeline.py:413)
2025-06-27 14:16:00 [    INFO] Dataset file size: 21.31 MB (foundation_model_pipeline.py:414)
2025-06-27 14:16:00 [    INFO] Dataset HDF5 structure: (foundation_model_pipeline.py:421)
2025-06-27 14:16:00 [    INFO]   Group: features (foundation_model_pipeline.py:429)
2025-06-27 14:16:00 [    INFO]   Group: features/aggregated (foundation_model_pipeline.py:429)
2025-06-27 14:16:00 [    INFO]   Dataset: features/aggregated/aggregator_0, Shape: (45628, 30, 6), Type: float32 (foundation_model_pipeline.py:425)
2025-06-27 14:16:00 [    INFO]   Group: labels (foundation_model_pipeline.py:429)
2025-06-27 14:16:00 [    INFO]   Group: labels/config_0 (foundation_model_pipeline.py:429)
2025-06-27 14:16:00 [    INFO]   Group: labels/config_0/aggregated (foundation_model_pipeline.py:429)
2025-06-27 14:16:00 [    INFO]   Dataset: labels/config_0/aggregated/aggregator_0, Shape: (45628, 1, 3), Type: float32 (foundation_model_pipeline.py:425)
2025-06-27 14:16:00 [    INFO] Registering experiment... (foundation_model_pipeline.py:438)
2025-06-27 14:16:00 [    INFO] Experiment info saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/_experiment_info.json (model_registry.py:136)
2025-06-27 14:16:00 [    INFO] Source config file saved as: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/_experiment_config.yaml (model_registry.py:149)
2025-06-27 14:16:00 [    INFO] Created experiment: 001_Foundation_VAE_Model (foundation_model_pipeline.py:459)
2025-06-27 14:16:00 [    INFO] Creating model... (foundation_model_pipeline.py:462)
2025-06-27 14:16:02 [    INFO] Built encoder layers (variational_autoencoder.py:283)
2025-06-27 14:16:02 [    INFO] Built encoder model (variational_autoencoder.py:310)
2025-06-27 14:16:02 [    INFO] Built deterministic encoder model (variational_autoencoder.py:316)
2025-06-27 14:16:02 [    INFO] Built decoder layers (variational_autoencoder.py:341)
2025-06-27 14:16:02 [    INFO] Built decoder model (variational_autoencoder.py:358)
2025-06-27 14:16:02 [    INFO] Completed VAE architecture build (variational_autoencoder.py:369)
2025-06-27 14:16:02 [    INFO] Model created (foundation_model_pipeline.py:475)
2025-06-27 14:16:02 [    INFO] None (foundation_model_pipeline.py:476)
2025-06-27 14:16:02 [    INFO] Setting up model and callbacks... (foundation_model_pipeline.py:479)
2025-06-27 14:16:02 [    INFO] Added BetaSchedule callback: start=0.01, end=0.1, warmup_epochs=1, cycle_epochs=1 (foundation_model_pipeline.py:503)
2025-06-27 14:16:02 [    INFO] Starting training... (foundation_model_pipeline.py:511)
2025-06-27 14:16:02 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:16:02 [    INFO] Will save training plots to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:260)
2025-06-27 14:16:02 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:16:03 [    INFO] Training dataset batches: 36 (model_trainer.py:275)
2025-06-27 14:16:03 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:16:03 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:16:03 [    INFO]   Targets: (1024, 180) (model_trainer.py:280)
2025-06-27 14:16:03 [    INFO] Starting training for 10 epochs (model_trainer.py:27)
2025-06-27 14:16:03 [    INFO] Epoch 1: beta = 0.0100 (variational_autoencoder.py:218)
2025-06-27 14:16:03 [    INFO] Starting epoch 1/10 (model_trainer.py:31)
2025-06-27 14:16:07 [    INFO] Epoch 1/10 completed in 4.4s - loss: 4.940177 - mse: 2.463415 - total_loss: 2.472352 - reconstruction_loss: 2.458985 - kl_loss: 1.336594 - val_loss: 2.819020 - val_mse: 1.407274 - val_total_loss: 1.403521 - val_reconstruction_loss: 1.399026 - val_kl_loss: 0.449539 (model_trainer.py:36)
2025-06-27 14:16:07 [    INFO] Epoch 2: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:07 [    INFO] Starting epoch 2/10 (model_trainer.py:31)
2025-06-27 14:16:12 [    INFO] Epoch 2/10 completed in 4.6s - loss: 3.893748 - mse: 1.899670 - total_loss: 1.991352 - reconstruction_loss: 1.896872 - kl_loss: 1.717821 - val_loss: 2.708927 - val_mse: 1.334167 - val_total_loss: 1.367175 - val_reconstruction_loss: 1.326595 - val_kl_loss: 0.737829 (model_trainer.py:36)
2025-06-27 14:16:12 [    INFO] Epoch 3: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:12 [    INFO] Starting epoch 3/10 (model_trainer.py:31)
2025-06-27 14:16:16 [    INFO] Epoch 3/10 completed in 4.5s - loss: 3.271908 - mse: 1.582429 - total_loss: 1.686970 - reconstruction_loss: 1.579873 - kl_loss: 1.947227 - val_loss: 2.572753 - val_mse: 1.259289 - val_total_loss: 1.306554 - val_reconstruction_loss: 1.252377 - val_kl_loss: 0.985043 (model_trainer.py:36)
2025-06-27 14:16:16 [    INFO] Epoch 4: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:16 [    INFO] Starting epoch 4/10 (model_trainer.py:31)
2025-06-27 14:16:21 [    INFO] Epoch 4/10 completed in 4.5s - loss: 2.839535 - mse: 1.363339 - total_loss: 1.474437 - reconstruction_loss: 1.361626 - kl_loss: 2.051120 - val_loss: 2.440700 - val_mse: 1.189036 - val_total_loss: 1.244162 - val_reconstruction_loss: 1.181555 - val_kl_loss: 1.138312 (model_trainer.py:36)
2025-06-27 14:16:21 [    INFO] Epoch 5: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:21 [    INFO] Starting epoch 5/10 (model_trainer.py:31)
2025-06-27 14:16:26 [    INFO] Epoch 5/10 completed in 4.7s - loss: 2.541945 - mse: 1.217240 - total_loss: 1.322873 - reconstruction_loss: 1.215436 - kl_loss: 1.953400 - val_loss: 2.317589 - val_mse: 1.124364 - val_total_loss: 1.186316 - val_reconstruction_loss: 1.117445 - val_kl_loss: 1.252213 (model_trainer.py:36)
2025-06-27 14:16:26 [    INFO] Epoch 6: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:26 [    INFO] Starting epoch 6/10 (model_trainer.py:31)
2025-06-27 14:16:30 [    INFO] Epoch 6/10 completed in 4.5s - loss: 2.333467 - mse: 1.117455 - total_loss: 1.214517 - reconstruction_loss: 1.116004 - kl_loss: 1.791146 - val_loss: 2.201699 - val_mse: 1.065522 - val_total_loss: 1.129180 - val_reconstruction_loss: 1.058541 - val_kl_loss: 1.284350 (model_trainer.py:36)
2025-06-27 14:16:30 [    INFO] Epoch 7: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:30 [    INFO] Starting epoch 7/10 (model_trainer.py:31)
2025-06-27 14:16:35 [    INFO] Epoch 7/10 completed in 4.7s - loss: 2.175185 - mse: 1.041241 - total_loss: 1.132523 - reconstruction_loss: 1.039856 - kl_loss: 1.684865 - val_loss: 2.105843 - val_mse: 1.016723 - val_total_loss: 1.082759 - val_reconstruction_loss: 1.010360 - val_kl_loss: 1.316346 (model_trainer.py:36)
2025-06-27 14:16:35 [    INFO] Epoch 8: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:35 [    INFO] Starting epoch 8/10 (model_trainer.py:31)
2025-06-27 14:16:40 [    INFO] Epoch 8/10 completed in 5.4s - loss: 2.060035 - mse: 0.987978 - total_loss: 1.070958 - reconstruction_loss: 0.986918 - kl_loss: 1.528013 - val_loss: 2.033441 - val_mse: 0.981866 - val_total_loss: 1.045658 - val_reconstruction_loss: 0.975968 - val_kl_loss: 1.267088 (model_trainer.py:36)
2025-06-27 14:16:40 [    INFO] Epoch 9: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:40 [    INFO] Starting epoch 9/10 (model_trainer.py:31)
2025-06-27 14:16:46 [    INFO] Epoch 9/10 completed in 6.0s - loss: 1.965954 - mse: 0.944185 - total_loss: 1.020803 - reconstruction_loss: 0.943256 - kl_loss: 1.409957 - val_loss: 1.976278 - val_mse: 0.954504 - val_total_loss: 1.016302 - val_reconstruction_loss: 0.949079 - val_kl_loss: 1.222237 (model_trainer.py:36)
2025-06-27 14:16:46 [    INFO] Epoch 10: beta = 0.0550 (variational_autoencoder.py:218)
2025-06-27 14:16:46 [    INFO] Starting epoch 10/10 (model_trainer.py:31)
2025-06-27 14:16:51 [    INFO] Epoch 10/10 completed in 4.8s - loss: 1.890990 - mse: 0.909957 - total_loss: 0.979898 - reconstruction_loss: 0.908864 - kl_loss: 1.291521 - val_loss: 1.926873 - val_mse: 0.931643 - val_total_loss: 0.989243 - val_reconstruction_loss: 0.925695 - val_kl_loss: 1.155428 (model_trainer.py:36)
2025-06-27 14:16:51 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:16:51 [    INFO]   loss: 1.890990 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   mse: 0.909957 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   total_loss: 0.979898 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   reconstruction_loss: 0.908864 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   kl_loss: 1.291521 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   val_loss: 1.926873 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   val_mse: 0.931643 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   val_total_loss: 0.989243 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   val_reconstruction_loss: 0.925695 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO]   val_kl_loss: 1.155428 (model_trainer.py:320)
2025-06-27 14:16:51 [    INFO] Generating training plots... (model_trainer.py:324)
2025-06-27 14:16:51 [    INFO] Creating training plots in: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:331)
2025-06-27 14:16:53 [    INFO] Creating VAE-specific plots... (variational_autoencoder.py:387)
2025-06-27 14:16:53 [    INFO] Available metrics: ['loss', 'mse', 'total_loss', 'reconstruction_loss', 'kl_loss', 'val_loss', 'val_mse', 'val_total_loss', 'val_reconstruction_loss', 'val_kl_loss'] (variational_autoencoder.py:397)
2025-06-27 14:16:54 [    INFO] Created training history plot (variational_autoencoder.py:499)
2025-06-27 14:16:54 [    INFO] VAE plots saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (variational_autoencoder.py:559)
2025-06-27 14:16:54 [    INFO] Plots saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_trainer.py:382)
2025-06-27 14:16:54 [    INFO] Evaluating model... (foundation_model_pipeline.py:522)
2025-06-27 14:16:54 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:16:54 [    INFO]   test_loss: 1.726479 (model_trainer.py:409)
2025-06-27 14:16:54 [    INFO]   test_mse: 0.831025 (model_trainer.py:409)
2025-06-27 14:16:54 [    INFO]   test_total_loss: 0.893426 (model_trainer.py:409)
2025-06-27 14:16:54 [    INFO]   test_reconstruction_loss: 0.828974 (model_trainer.py:409)
2025-06-27 14:16:54 [    INFO]   test_kl_loss: 1.171862 (model_trainer.py:409)
2025-06-27 14:16:54 [    INFO] Training results saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/training (model_registry.py:234)
2025-06-27 14:16:54 [    INFO] Saving trained model... (foundation_model_pipeline.py:541)
2025-06-27 14:16:54 [ WARNING] Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model. (saving_utils.py:359)
2025-06-27 14:16:56 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/encoder/assets (builder_impl.py:804)
2025-06-27 14:16:56 [ WARNING] Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model. (saving_utils.py:359)
2025-06-27 14:16:57 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/deterministic_encoder/assets (builder_impl.py:804)
2025-06-27 14:16:57 [ WARNING] Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model. (saving_utils.py:359)
2025-06-27 14:16:58 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/decoder/assets (builder_impl.py:804)
2025-06-27 14:17:04 [    INFO] Assets written to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/full_model/assets (builder_impl.py:804)
2025-06-27 14:17:04 [    INFO] Model saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model (model_registry.py:277)
2025-06-27 14:17:04 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:586)
2025-06-27 14:17:04 [    INFO] Experiment Results (foundation_model_pipeline.py:587)
2025-06-27 14:17:04 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:588)
2025-06-27 14:17:04 [    INFO] Experiment ID: 001_Foundation_VAE_Model (foundation_model_pipeline.py:592)
2025-06-27 14:17:04 [    INFO] Status: completed (foundation_model_pipeline.py:593)
2025-06-27 14:17:04 [    INFO] Training Duration: 48.70s (foundation_model_pipeline.py:597)
2025-06-27 14:17:04 [    INFO] Epochs Completed: 10 (foundation_model_pipeline.py:600)
2025-06-27 14:17:04 [    INFO] Metrics: (foundation_model_pipeline.py:604)
2025-06-27 14:17:04 [    INFO]   loss: 1.890990 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   mse: 0.909957 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   total_loss: 0.979898 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   reconstruction_loss: 0.908864 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   kl_loss: 1.291521 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   val_loss: 1.926873 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   val_mse: 0.931643 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   val_total_loss: 0.989243 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   val_reconstruction_loss: 0.925695 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   val_kl_loss: 1.155428 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   test_loss: 1.726479 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   test_mse: 0.831025 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   test_total_loss: 0.893426 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   test_reconstruction_loss: 0.828974 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO]   test_kl_loss: 1.171862 (foundation_model_pipeline.py:614)
2025-06-27 14:17:04 [    INFO] Foundation model training completed successfully (foundation_model_pipeline.py:620)
2025-06-27 14:17:04 [    INFO] Foundation model saved at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:624)
2025-06-27 14:17:04 [    INFO] Training completed successfully. Model saved at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:245)
2025-06-27 14:17:04 [    INFO]
================================================== (foundation_model_pipeline.py:250)
2025-06-27 14:17:04 [    INFO] STEP 2/4: REGRESSION EVALUATION (foundation_model_pipeline.py:251)
2025-06-27 14:17:04 [    INFO] ================================================== (foundation_model_pipeline.py:252)
2025-06-27 14:17:04 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:907)
2025-06-27 14:17:04 [    INFO] Evaluating Foundation Model for Regression (Data Efficiency Study) (foundation_model_pipeline.py:908)
2025-06-27 14:17:04 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:911)
2025-06-27 14:17:04 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 14:17:04 [    INFO] Loading full dataset with regression labels... (foundation_model_pipeline.py:928)
2025-06-27 14:17:04 [    INFO] Loading datasets (dataset_manager.py:769)
2025-06-27 14:17:04 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:17:05 [    INFO] Total training events available: 36503 (foundation_model_pipeline.py:945)
2025-06-27 14:17:05 [    INFO] Data sizes to test: [1000, 2000] (foundation_model_pipeline.py:949)
2025-06-27 14:17:05 [    INFO] Loading foundation model configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:952)
2025-06-27 14:17:05 [    INFO] Loading pre-trained deterministic encoder from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/deterministic_encoder (foundation_model_pipeline.py:995)
2025-06-27 14:17:05 [ WARNING] No training configuration found in save file, so the model was *not* compiled. Compile it manually. (load.py:178)
2025-06-27 14:17:05 [    INFO] Loaded deterministic encoder with output shape: (None, 2) (foundation_model_pipeline.py:1002)
2025-06-27 14:17:05 [    INFO] Deterministic encoder layers: (foundation_model_pipeline.py:1005)
2025-06-27 14:17:05 [    INFO]   encoder_input: [(None, 180)] (foundation_model_pipeline.py:1007)
2025-06-27 14:17:05 [    INFO]   reshape: (None, 180) (foundation_model_pipeline.py:1007)
2025-06-27 14:17:05 [    INFO]   encoder_0_dense: (None, 8) (foundation_model_pipeline.py:1007)
2025-06-27 14:17:05 [    INFO]   encoder_0_activation: (None, 8) (foundation_model_pipeline.py:1007)
2025-06-27 14:17:05 [    INFO]   encoder_0_bn: (None, 8) (foundation_model_pipeline.py:1007)
2025-06-27 14:17:05 [    INFO]   z_mean: (None, 2) (foundation_model_pipeline.py:1007)
2025-06-27 14:17:05 [    INFO]
================================================== (foundation_model_pipeline.py:1104)
2025-06-27 14:17:05 [    INFO] Training with 1000 events (foundation_model_pipeline.py:1105)
2025-06-27 14:17:05 [    INFO] ================================================== (foundation_model_pipeline.py:1106)
2025-06-27 14:17:05 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1112)
2025-06-27 14:17:06 [    INFO] Training From_Scratch model with 1000 events... (foundation_model_pipeline.py:1052)
2025-06-27 14:17:06 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:06 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:07 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:07 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:07 [    INFO]   Features: (1000, 180) (model_trainer.py:279)
2025-06-27 14:17:07 [    INFO]   Targets: (1000, 3) (model_trainer.py:280)
2025-06-27 14:17:07 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:07 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:17:07 [    INFO] Epoch 1/3 completed in 0.4s - loss: 1.894137 - mse: 1.893952 - mae: 1.051941 - val_loss: 1.777092 - val_mse: 1.776907 - val_mae: 0.969331 (model_trainer.py:36)
2025-06-27 14:17:07 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:17:07 [    INFO] Epoch 2/3 completed in 0.3s - loss: 1.843693 - mse: 1.843509 - mae: 1.047039 - val_loss: 1.770767 - val_mse: 1.770583 - val_mae: 0.967217 (model_trainer.py:36)
2025-06-27 14:17:07 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:17:08 [    INFO] Epoch 3/3 completed in 0.3s - loss: 1.766864 - mse: 1.766679 - mae: 1.020961 - val_loss: 1.769473 - val_mse: 1.769288 - val_mae: 0.966758 (model_trainer.py:36)
2025-06-27 14:17:08 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:17:08 [    INFO]   loss: 1.766864 (model_trainer.py:320)
2025-06-27 14:17:08 [    INFO]   mse: 1.766679 (model_trainer.py:320)
2025-06-27 14:17:08 [    INFO]   mae: 1.020961 (model_trainer.py:320)
2025-06-27 14:17:08 [    INFO]   val_loss: 1.769473 (model_trainer.py:320)
2025-06-27 14:17:08 [    INFO]   val_mse: 1.769288 (model_trainer.py:320)
2025-06-27 14:17:08 [    INFO]   val_mae: 0.966758 (model_trainer.py:320)
2025-06-27 14:17:08 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:17:08 [    INFO]   test_loss: 1.844331 (model_trainer.py:409)
2025-06-27 14:17:08 [    INFO]   test_mse: 1.844146 (model_trainer.py:409)
2025-06-27 14:17:08 [    INFO]   test_mae: 0.980233 (model_trainer.py:409)
2025-06-27 14:17:08 [    INFO] From_Scratch with 1000 events - Test Loss: 1.844331 (foundation_model_pipeline.py:1089)
2025-06-27 14:17:08 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1144)
2025-06-27 14:17:09 [    INFO] Training Fine_Tuned model with 1000 events... (foundation_model_pipeline.py:1052)
2025-06-27 14:17:09 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:09 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:09 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:09 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:09 [    INFO]   Features: (1000, 180) (model_trainer.py:279)
2025-06-27 14:17:09 [    INFO]   Targets: (1000, 3) (model_trainer.py:280)
2025-06-27 14:17:09 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:09 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:17:10 [    INFO] Epoch 1/3 completed in 0.7s - loss: 2.456016 - mse: 2.455894 - mae: 1.222739 - val_loss: 1.961808 - val_mse: 1.961686 - val_mae: 1.042310 (model_trainer.py:36)
2025-06-27 14:17:10 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:17:10 [    INFO] Epoch 2/3 completed in 0.4s - loss: 2.383773 - mse: 2.383652 - mae: 1.212773 - val_loss: 1.958354 - val_mse: 1.958232 - val_mae: 1.041051 (model_trainer.py:36)
2025-06-27 14:17:10 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:17:10 [    INFO] Epoch 3/3 completed in 0.4s - loss: 2.402130 - mse: 2.402008 - mae: 1.210511 - val_loss: 1.949009 - val_mse: 1.948887 - val_mae: 1.037874 (model_trainer.py:36)
2025-06-27 14:17:10 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:17:10 [    INFO]   loss: 2.402130 (model_trainer.py:320)
2025-06-27 14:17:10 [    INFO]   mse: 2.402008 (model_trainer.py:320)
2025-06-27 14:17:10 [    INFO]   mae: 1.210511 (model_trainer.py:320)
2025-06-27 14:17:10 [    INFO]   val_loss: 1.949009 (model_trainer.py:320)
2025-06-27 14:17:10 [    INFO]   val_mse: 1.948887 (model_trainer.py:320)
2025-06-27 14:17:10 [    INFO]   val_mae: 1.037874 (model_trainer.py:320)
2025-06-27 14:17:11 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:17:11 [    INFO]   test_loss: 1.996400 (model_trainer.py:409)
2025-06-27 14:17:11 [    INFO]   test_mse: 1.996278 (model_trainer.py:409)
2025-06-27 14:17:11 [    INFO]   test_mae: 1.038702 (model_trainer.py:409)
2025-06-27 14:17:11 [    INFO] Fine_Tuned with 1000 events - Test Loss: 1.996400 (foundation_model_pipeline.py:1089)
2025-06-27 14:17:11 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1178)
2025-06-27 14:17:11 [    INFO] Training Fixed_Encoder model with 1000 events... (foundation_model_pipeline.py:1052)
2025-06-27 14:17:11 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:11 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:11 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:11 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:11 [    INFO]   Features: (1000, 180) (model_trainer.py:279)
2025-06-27 14:17:11 [    INFO]   Targets: (1000, 3) (model_trainer.py:280)
2025-06-27 14:17:11 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:11 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:17:12 [    INFO] Epoch 1/3 completed in 0.4s - loss: 3.805129 - mse: 3.805051 - mae: 1.516374 - val_loss: 2.058314 - val_mse: 2.058236 - val_mae: 1.060756 (model_trainer.py:36)
2025-06-27 14:17:12 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:17:12 [    INFO] Epoch 2/3 completed in 0.3s - loss: 3.873661 - mse: 3.873583 - mae: 1.540639 - val_loss: 2.058822 - val_mse: 2.058745 - val_mae: 1.060465 (model_trainer.py:36)
2025-06-27 14:17:12 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:17:12 [    INFO] Epoch 3/3 completed in 0.4s - loss: 3.712775 - mse: 3.712698 - mae: 1.499024 - val_loss: 2.059169 - val_mse: 2.059091 - val_mae: 1.060258 (model_trainer.py:36)
2025-06-27 14:17:12 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:17:12 [    INFO]   loss: 3.712775 (model_trainer.py:320)
2025-06-27 14:17:12 [    INFO]   mse: 3.712698 (model_trainer.py:320)
2025-06-27 14:17:12 [    INFO]   mae: 1.499024 (model_trainer.py:320)
2025-06-27 14:17:12 [    INFO]   val_loss: 2.059169 (model_trainer.py:320)
2025-06-27 14:17:12 [    INFO]   val_mse: 2.059091 (model_trainer.py:320)
2025-06-27 14:17:12 [    INFO]   val_mae: 1.060258 (model_trainer.py:320)
2025-06-27 14:17:13 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:17:13 [    INFO]   test_loss: 2.149446 (model_trainer.py:409)
2025-06-27 14:17:13 [    INFO]   test_mse: 2.149368 (model_trainer.py:409)
2025-06-27 14:17:13 [    INFO]   test_mae: 1.084278 (model_trainer.py:409)
2025-06-27 14:17:13 [    INFO] Fixed_Encoder with 1000 events - Test Loss: 2.149446 (foundation_model_pipeline.py:1089)
2025-06-27 14:17:13 [    INFO]
================================================== (foundation_model_pipeline.py:1104)
2025-06-27 14:17:13 [    INFO] Training with 2000 events (foundation_model_pipeline.py:1105)
2025-06-27 14:17:13 [    INFO] ================================================== (foundation_model_pipeline.py:1106)
2025-06-27 14:17:13 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1112)
2025-06-27 14:17:13 [    INFO] Training From_Scratch model with 2000 events... (foundation_model_pipeline.py:1052)
2025-06-27 14:17:13 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:13 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:13 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:13 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:13 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:17:13 [    INFO]   Targets: (1024, 3) (model_trainer.py:280)
2025-06-27 14:17:13 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:13 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:17:14 [    INFO] Epoch 1/3 completed in 0.5s - loss: 2.640818 - mse: 2.640683 - mae: 1.242170 - val_loss: 2.048858 - val_mse: 2.048724 - val_mae: 1.070630 (model_trainer.py:36)
2025-06-27 14:17:14 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:17:14 [    INFO] Epoch 2/3 completed in 0.4s - loss: 2.527140 - mse: 2.527006 - mae: 1.220124 - val_loss: 2.056109 - val_mse: 2.055975 - val_mae: 1.072230 (model_trainer.py:36)
2025-06-27 14:17:14 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:17:14 [    INFO] Epoch 3/3 completed in 0.4s - loss: 2.442090 - mse: 2.441956 - mae: 1.206602 - val_loss: 2.072609 - val_mse: 2.072475 - val_mae: 1.076574 (model_trainer.py:36)
2025-06-27 14:17:14 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:17:14 [    INFO]   loss: 2.442090 (model_trainer.py:320)
2025-06-27 14:17:14 [    INFO]   mse: 2.441956 (model_trainer.py:320)
2025-06-27 14:17:14 [    INFO]   mae: 1.206602 (model_trainer.py:320)
2025-06-27 14:17:14 [    INFO]   val_loss: 2.072609 (model_trainer.py:320)
2025-06-27 14:17:14 [    INFO]   val_mse: 2.072475 (model_trainer.py:320)
2025-06-27 14:17:14 [    INFO]   val_mae: 1.076574 (model_trainer.py:320)
2025-06-27 14:17:15 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:17:15 [    INFO]   test_loss: 2.121633 (model_trainer.py:409)
2025-06-27 14:17:15 [    INFO]   test_mse: 2.121498 (model_trainer.py:409)
2025-06-27 14:17:15 [    INFO]   test_mae: 1.078825 (model_trainer.py:409)
2025-06-27 14:17:15 [    INFO] From_Scratch with 2000 events - Test Loss: 2.121633 (foundation_model_pipeline.py:1089)
2025-06-27 14:17:15 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1144)
2025-06-27 14:17:15 [    INFO] Training Fine_Tuned model with 2000 events... (foundation_model_pipeline.py:1052)
2025-06-27 14:17:15 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:15 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:15 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:15 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:15 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:17:15 [    INFO]   Targets: (1024, 3) (model_trainer.py:280)
2025-06-27 14:17:15 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:15 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:17:16 [    INFO] Epoch 1/3 completed in 0.5s - loss: 3.719226 - mse: 3.719049 - mae: 1.581579 - val_loss: 2.136513 - val_mse: 2.136336 - val_mae: 1.129740 (model_trainer.py:36)
2025-06-27 14:17:16 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:17:16 [    INFO] Epoch 2/3 completed in 0.4s - loss: 3.665673 - mse: 3.665496 - mae: 1.568473 - val_loss: 2.119985 - val_mse: 2.119808 - val_mae: 1.124244 (model_trainer.py:36)
2025-06-27 14:17:16 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:17:17 [    INFO] Epoch 3/3 completed in 0.4s - loss: 3.647823 - mse: 3.647646 - mae: 1.567490 - val_loss: 2.110995 - val_mse: 2.110818 - val_mae: 1.120739 (model_trainer.py:36)
2025-06-27 14:17:17 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:17:17 [    INFO]   loss: 3.647823 (model_trainer.py:320)
2025-06-27 14:17:17 [    INFO]   mse: 3.647646 (model_trainer.py:320)
2025-06-27 14:17:17 [    INFO]   mae: 1.567490 (model_trainer.py:320)
2025-06-27 14:17:17 [    INFO]   val_loss: 2.110995 (model_trainer.py:320)
2025-06-27 14:17:17 [    INFO]   val_mse: 2.110818 (model_trainer.py:320)
2025-06-27 14:17:17 [    INFO]   val_mae: 1.120739 (model_trainer.py:320)
2025-06-27 14:17:17 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:17:17 [    INFO]   test_loss: 2.274246 (model_trainer.py:409)
2025-06-27 14:17:17 [    INFO]   test_mse: 2.274070 (model_trainer.py:409)
2025-06-27 14:17:17 [    INFO]   test_mae: 1.166697 (model_trainer.py:409)
2025-06-27 14:17:17 [    INFO] Fine_Tuned with 2000 events - Test Loss: 2.274246 (foundation_model_pipeline.py:1089)
2025-06-27 14:17:17 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1178)
2025-06-27 14:17:17 [    INFO] Training Fixed_Encoder model with 2000 events... (foundation_model_pipeline.py:1052)
2025-06-27 14:17:17 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:17 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:17 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:17 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:17 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:17:17 [    INFO]   Targets: (1024, 3) (model_trainer.py:280)
2025-06-27 14:17:17 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:17 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:17:18 [    INFO] Epoch 1/3 completed in 0.6s - loss: 1.298493 - mse: 1.298290 - mae: 0.895402 - val_loss: 2.209534 - val_mse: 2.209331 - val_mae: 1.119733 (model_trainer.py:36)
2025-06-27 14:17:18 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:17:18 [    INFO] Epoch 2/3 completed in 0.4s - loss: 1.274296 - mse: 1.274093 - mae: 0.886570 - val_loss: 2.189544 - val_mse: 2.189341 - val_mae: 1.113327 (model_trainer.py:36)
2025-06-27 14:17:18 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:17:19 [    INFO] Epoch 3/3 completed in 0.4s - loss: 1.250965 - mse: 1.250762 - mae: 0.879465 - val_loss: 2.180484 - val_mse: 2.180280 - val_mae: 1.110450 (model_trainer.py:36)
2025-06-27 14:17:19 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:17:19 [    INFO]   loss: 1.250965 (model_trainer.py:320)
2025-06-27 14:17:19 [    INFO]   mse: 1.250762 (model_trainer.py:320)
2025-06-27 14:17:19 [    INFO]   mae: 0.879465 (model_trainer.py:320)
2025-06-27 14:17:19 [    INFO]   val_loss: 2.180484 (model_trainer.py:320)
2025-06-27 14:17:19 [    INFO]   val_mse: 2.180280 (model_trainer.py:320)
2025-06-27 14:17:19 [    INFO]   val_mae: 1.110450 (model_trainer.py:320)
2025-06-27 14:17:19 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:17:19 [    INFO]   test_loss: 2.288888 (model_trainer.py:409)
2025-06-27 14:17:19 [    INFO]   test_mse: 2.288684 (model_trainer.py:409)
2025-06-27 14:17:19 [    INFO]   test_mae: 1.134630 (model_trainer.py:409)
2025-06-27 14:17:19 [    INFO] Fixed_Encoder with 2000 events - Test Loss: 2.288888 (foundation_model_pipeline.py:1089)
2025-06-27 14:17:19 [    INFO] Creating data efficiency plot... (foundation_model_pipeline.py:1212)
2025-06-27 14:17:19 [    INFO] Results saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/regression_data_efficiency_results.json (foundation_model_pipeline.py:1218)
2025-06-27 14:17:20 [    INFO] Data efficiency plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/regression_evaluation/regression_data_efficiency_plot.png (foundation_model_pipeline.py:1280)
2025-06-27 14:17:20 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1286)
2025-06-27 14:17:20 [    INFO] Regression Evaluation Results Summary (foundation_model_pipeline.py:1287)
2025-06-27 14:17:20 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1288)
2025-06-27 14:17:20 [    INFO] Training Events: 1000 (foundation_model_pipeline.py:1291)
2025-06-27 14:17:20 [    INFO]   From Scratch:  1.844331 (foundation_model_pipeline.py:1292)
2025-06-27 14:17:20 [    INFO]   Fine-Tuned:    1.996400 (foundation_model_pipeline.py:1293)
2025-06-27 14:17:20 [    INFO]   Fixed Encoder: 2.149446 (foundation_model_pipeline.py:1294)
2025-06-27 14:17:20 [    INFO]   Fine-Tuned improvement: -8.2% (foundation_model_pipeline.py:1308)
2025-06-27 14:17:20 [    INFO]   Fixed improvement: -16.5% (foundation_model_pipeline.py:1309)
2025-06-27 14:17:20 [    INFO]  (foundation_model_pipeline.py:1310)
2025-06-27 14:17:20 [    INFO] Training Events: 2000 (foundation_model_pipeline.py:1291)
2025-06-27 14:17:20 [    INFO]   From Scratch:  2.121633 (foundation_model_pipeline.py:1292)
2025-06-27 14:17:20 [    INFO]   Fine-Tuned:    2.274246 (foundation_model_pipeline.py:1293)
2025-06-27 14:17:20 [    INFO]   Fixed Encoder: 2.288888 (foundation_model_pipeline.py:1294)
2025-06-27 14:17:20 [    INFO]   Fine-Tuned improvement: -7.2% (foundation_model_pipeline.py:1308)
2025-06-27 14:17:20 [    INFO]   Fixed improvement: -7.9% (foundation_model_pipeline.py:1309)
2025-06-27 14:17:20 [    INFO]  (foundation_model_pipeline.py:1310)
2025-06-27 14:17:20 [    INFO] Regression evaluation completed successfully (foundation_model_pipeline.py:1312)
2025-06-27 14:17:20 [    INFO] Regression evaluation completed successfully (foundation_model_pipeline.py:270)
2025-06-27 14:17:20 [    INFO]
================================================== (foundation_model_pipeline.py:273)
2025-06-27 14:17:20 [    INFO] STEP 3/4: SIGNAL CLASSIFICATION EVALUATION (foundation_model_pipeline.py:274)
2025-06-27 14:17:20 [    INFO] ================================================== (foundation_model_pipeline.py:275)
2025-06-27 14:17:20 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1350)
2025-06-27 14:17:20 [    INFO] Evaluating Foundation Model for Signal Classification (Data Efficiency Study) (foundation_model_pipeline.py:1351)
2025-06-27 14:17:20 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1354)
2025-06-27 14:17:20 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 14:17:20 [    INFO] Loading background dataset... (foundation_model_pipeline.py:1377)
2025-06-27 14:17:20 [    INFO] Loading datasets (dataset_manager.py:769)
2025-06-27 14:17:20 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:17:21 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:17:21 [    INFO] Found background histogram data for comparison at /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/atlas_dataset_features_hist_data.json (foundation_model_pipeline.py:1398)
2025-06-27 14:17:21 [    INFO] Loading signal dataset: zprime_tt (foundation_model_pipeline.py:1408)
2025-06-27 14:17:21 [    INFO] Loading signal datasets (dataset_manager.py:850)
2025-06-27 14:17:21 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:17:21 [    INFO] [Debug] Creating new signal dataset (dataset_manager.py:445)
2025-06-27 14:17:21 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:17:21 [    INFO] [Debug] Signal dataset directory: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:422)
2025-06-27 14:17:21 [    INFO] [Debug] Signal dataset path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/signal_dataset.h5 (dataset_manager.py:423)
2025-06-27 14:17:21 [    INFO] [Debug] Signal config path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/_dataset_config.yaml (dataset_manager.py:424)
2025-06-27 14:17:21 [    INFO] [Debug] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:454)
2025-06-27 14:17:21 [    INFO] [Debug] Signal keys to process: ['zprime_tt', 'zprime_bb'] (dataset_manager.py:455)
2025-06-27 14:17:21 [    INFO] [Debug] Will create dataset at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/signal_dataset.h5 (dataset_manager.py:458)
2025-06-27 14:17:21 [    INFO] [Debug] Created HDF5 file, processing signal types... (dataset_manager.py:465)
2025-06-27 14:17:21 [    INFO] [Debug] Processing signal type: zprime_tt (dataset_manager.py:470)
2025-06-27 14:17:21 [    INFO] [Debug] plot_output for signal JSON data naming: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_tt_dataset_features.png (dataset_manager.py:485)
2025-06-27 14:17:21 [    INFO] Processing signal data for zprime_tt (physlite_feature_processor.py:1001)
2025-06-27 14:17:21 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 14:17:21 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 14:17:21 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 14:17:21 [    INFO] [debug] Initially required branches (incl. derived): {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1033)
2025-06-27 14:17:21 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta'} (physlite_feature_processor.py:1061)
2025-06-27 14:17:21 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1064)
2025-06-27 14:17:21 [    INFO] Actual branches to read from file: {'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1067)
2025-06-27 14:17:21 [    INFO] Getting catalog paths for run None and signal zprime_tt (physlite_feature_processor.py:1079)
2025-06-27 14:17:21 [    INFO] Found 1 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 14:17:21 [    INFO] Plotting enabled. Aiming for ~5000 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 14:17:21 [    INFO] Processing catalog 1/1 with path: atlas_data/signal_catalogs/zprime_tt_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 14:17:24 [    INFO] First event raw data (Catalog 1, Batch Event 0): {'MET_Core_AnalysisMETAuxDyn.mpy': array([-28080.973  ,   -480.25757], dtype=float32), 'MET_Core_AnalysisMETAuxDyn.sumet': array([134062.75 ,  17650.158], dtype=float32), 'InDetTrackParticlesAuxDyn.qOverP': array([-6.88729779e-05, -7.49233222e-05, -4.19900862e-05,  3.11629856e-06,
        2.21594146e-05,  8.60558575e-05, -1.23193995e-05, -1.22602913e-04,
       -7.88225807e-05,  1.54356734e-04, -1.68359576e-04,  2.18319648e-04,
       -1.04862367e-04,  1.58748997e-04,  1.60355085e-05, -1.07529406e-04,
        3.40674451e-04, -2.73564190e-04, -1.63854012e-04,  1.72301836e-04,
       -5.62896545e-04,  2.17947789e-04,  2.89525691e-04,  7.91665167e-04,
       -1.60520591e-04, -3.03287205e-04,  4.79536160e-04, -1.36414499e-04,
        3.70083697e-04,  5.03614574e-05,  1.33430600e-04,  1.37083218e-04,
        8.94576835e-04,  5.38433815e-05,  2.48747710e-05, -1.34258953e-04,
       -3.78335186e-04, -6.94320537e-04,  2.42699934e-05,  1.13653286e-05],
      dtype=float32), 'InDetTrackParticlesAuxDyn.numberDoF': array([50., 51., 48., 47., 49., 13., 50., 42., 52., 47., 47., 37., 41.,
       50., 11., 30., 37., 46., 49., 48., 31., 43., 43., 25., 43., 42.,
       49., 45., 32., 42., 32., 41., 46., 48., 44., 40., 45., 42., 43.,
        7.], dtype=float32), 'InDetTrackParticlesAuxDyn.phi': array([-0.05818282,  1.3982899 ,  1.5341188 ,  0.6163037 ,  1.5186731 ,
        1.4913832 , -0.10213986,  1.412859  , -2.432485  ,  1.4673381 ,
        1.314496  ,  1.3474834 ,  1.3524413 , -0.11480629, -2.3178213 ,
        1.5055143 ,  1.330226  , -2.442145  , -0.18980293, -0.01817804,
        2.0299375 , -2.4045262 , -2.3225908 , -2.2508059 , -2.3757944 ,
       -2.3680203 ,  1.8227509 ,  1.426772  ,  1.5975726 ,  1.3518956 ,
        1.4468066 , -0.12838049, -2.38856   , -2.3948889 , -2.3946338 ,
       -2.1732583 , -2.48524   , -2.8634093 , -2.402962  , -2.4014635 ],
      dtype=float32), 'InDetTrackParticlesAuxDyn.z0': array([ -0.58651  ,  -1.508032 ,  -1.4327418,  -1.5408484,  -1.5525199,
        -1.469102 ,  -1.1031151,  -1.4984596,  -1.6954488,  -1.5600672,
        -1.383324 ,  -1.5848802,  -1.5659577,  -3.7424617, -48.52611  ,
        -1.4975952,  -1.4187077,  -1.4246764,  -2.056273 ,  -6.5991955,
        -1.6417305,  -0.5975787,  -1.4289072,  -1.5119314,  -1.4564048,
        -2.7279751,  -1.3629615,  -1.409713 ,  -1.5893272,  -1.4522458,
        -1.3744906,  -1.3065273,  -1.4857976,  -1.5164562,  -1.4009899,
        -1.4455857,  -1.5065175,  -1.61813  ,  -2.340205 ,  -2.0381176],
      dtype=float32), 'InDetTrackParticlesAuxDyn.chiSquared': array([39.68761  , 45.527416 , 40.54496  , 55.20232  , 39.10388  ,
        6.746427 , 52.09819  , 25.88393  , 78.54185  , 49.836346 ,
       55.51817  , 33.003494 , 35.32415  , 59.210575 , 14.982703 ,
       36.490086 , 21.66626  , 45.031586 , 59.360317 , 42.974243 ,
       50.606705 , 36.700672 , 44.929665 , 29.943033 , 39.71574  ,
       44.76934  , 49.024624 , 41.543846 , 21.30998  , 41.158524 ,
       25.162868 , 40.444157 , 37.355495 , 47.007572 , 62.59239  ,
       41.839622 , 43.46009  , 34.444775 , 85.971    ,  6.4204445],
      dtype=float32), 'InDetTrackParticlesAuxDyn.d0': array([ 0.06315981,  0.02641817,  0.00526722, -0.03166306,  0.01539994,
        0.00645554,  0.09361396, -0.02334598, -0.04410928,  0.0078935 ,
        0.02875908,  0.00939019,  0.00270811,  0.16586912, -0.00861183,
        0.00786774,  0.07261597, -0.01097151,  0.62327695, -0.835527  ,
        0.07823467,  0.3680812 ,  0.02261261, -0.01511043,  0.00495181,
       -0.49200642,  0.05088731,  0.02342756, -0.02001536, -0.01254166,
        0.01431257,  0.0597809 ,  0.0397876 ,  0.01565352, -0.99626076,
       -0.00137191, -0.02123706,  0.32294223, -0.07225598, -0.23380579],
      dtype=float32), 'MET_Core_AnalysisMETAuxDyn.mpx': array([13848.573,  5955.593], dtype=float32), 'InDetTrackParticlesAuxDyn.theta': array([2.7394533 , 0.99543655, 0.9881067 , 2.7560174 , 0.9784497 ,
       0.83039397, 2.7664912 , 1.0583935 , 1.7444443 , 0.9834595 ,
       1.0973645 , 1.063562  , 1.0092902 , 2.6902037 , 2.9501855 ,
       0.81227714, 0.95550436, 1.9117035 , 2.7410786 , 2.6993623 ,
       0.7534586 , 1.7808875 , 1.7967434 , 1.2805961 , 1.8171558 ,
       1.6834267 , 1.2763314 , 0.9945401 , 0.8341607 , 1.0284545 ,
       0.7160402 , 2.819237  , 1.2278451 , 1.7918589 , 1.7703563 ,
       2.132401  , 1.5949131 , 1.0877056 , 1.760426  , 1.763081  ],
      dtype=float32)} (physlite_feature_processor.py:1201)
2025-06-27 14:17:41 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 14:17:41 [    INFO]   Total events read: 30000 (physlite_feature_processor.py:1404)
2025-06-27 14:17:41 [    INFO]   Events passing selection (incl. derived calc): 29817 (physlite_feature_processor.py:1405)
2025-06-27 14:17:41 [    INFO]   Processing time: 19.45s (physlite_feature_processor.py:1408)
2025-06-27 14:17:41 [    INFO]   Rate: 1542.3 events/s (physlite_feature_processor.py:1409)
2025-06-27 14:17:41 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_tt_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 14:17:41 [    INFO] Loaded bin edges metadata from /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:2014)
2025-06-27 14:17:41 [    INFO] Feature 'N_Tracks_per_Event': 0 values (0.0%) below bin range, 124 values (2.5%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Feature 'Track d0': 9 values (0.0%) below bin range, 6 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Feature 'Track z0': 714 values (0.5%) below bin range, 469 values (0.3%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Feature 'Track phi': 91 values (0.1%) below bin range, 133 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Feature 'Track Eta': 39 values (0.0%) below bin range, 69 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Feature 'Track pT': 21 values (0.0%) below bin range, 2765 values (1.9%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Feature 'Track Reduced Chi2': 150 values (0.1%) below bin range, 88 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:41 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/zprime_tt_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 14:17:41 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 14:17:43 [    INFO] [Debug] Processing signal type: zprime_bb (dataset_manager.py:470)
2025-06-27 14:17:43 [    INFO] [Debug] plot_output for signal JSON data naming: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_bb_dataset_features.png (dataset_manager.py:485)
2025-06-27 14:17:43 [    INFO] Processing signal data for zprime_bb (physlite_feature_processor.py:1001)
2025-06-27 14:17:43 [ WARNING] Plotting distributions is enabled. This will significantly slow down processing. (physlite_feature_processor.py:1016)
2025-06-27 14:17:43 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(InDetTrackParticlesAuxDyn.d0), FeatureArraySelector(InDetTrackParticlesAuxDyn.z0), FeatureArraySelector(InDetTrackParticlesAuxDyn.phi), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.eta), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.pt), FeatureArraySelector(derived.InDetTrackParticlesAuxDyn.reducedChiSquared)] (physlite_feature_processor.py:118)
2025-06-27 14:17:43 [    INFO] [debug] Adding aggregator branches: [FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpx), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.mpy), FeatureArraySelector(MET_Core_AnalysisMETAuxDyn.sumet)] (physlite_feature_processor.py:118)
2025-06-27 14:17:43 [    INFO] [debug] Initially required branches (incl. derived): {'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta', 'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'derived.InDetTrackParticlesAuxDyn.reducedChiSquared'} (physlite_feature_processor.py:1033)
2025-06-27 14:17:43 [    INFO] Identified derived features: {'derived.InDetTrackParticlesAuxDyn.reducedChiSquared', 'derived.InDetTrackParticlesAuxDyn.pt', 'derived.InDetTrackParticlesAuxDyn.eta'} (physlite_feature_processor.py:1061)
2025-06-27 14:17:43 [    INFO] Added dependencies for derived features: {'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1064)
2025-06-27 14:17:43 [    INFO] Actual branches to read from file: {'MET_Core_AnalysisMETAuxDyn.mpy', 'MET_Core_AnalysisMETAuxDyn.sumet', 'InDetTrackParticlesAuxDyn.qOverP', 'InDetTrackParticlesAuxDyn.numberDoF', 'InDetTrackParticlesAuxDyn.phi', 'InDetTrackParticlesAuxDyn.z0', 'InDetTrackParticlesAuxDyn.chiSquared', 'InDetTrackParticlesAuxDyn.d0', 'MET_Core_AnalysisMETAuxDyn.mpx', 'InDetTrackParticlesAuxDyn.theta'} (physlite_feature_processor.py:1067)
2025-06-27 14:17:43 [    INFO] Getting catalog paths for run None and signal zprime_bb (physlite_feature_processor.py:1079)
2025-06-27 14:17:43 [    INFO] Found 1 catalog paths to process. (physlite_feature_processor.py:1083)
2025-06-27 14:17:43 [    INFO] Plotting enabled. Aiming for ~5000 samples per catalog (total target: 5000). (physlite_feature_processor.py:1097)
2025-06-27 14:17:43 [    INFO] Processing catalog 1/1 with path: atlas_data/signal_catalogs/zprime_bb_catalog_0.root (physlite_feature_processor.py:1120)
2025-06-27 14:17:50 [    INFO] Catalog 0 summary: (physlite_feature_processor.py:1403)
2025-06-27 14:17:50 [    INFO]   Total events read: 10000 (physlite_feature_processor.py:1404)
2025-06-27 14:17:50 [    INFO]   Events passing selection (incl. derived calc): 9752 (physlite_feature_processor.py:1405)
2025-06-27 14:17:50 [    INFO]   Processing time: 7.36s (physlite_feature_processor.py:1408)
2025-06-27 14:17:50 [    INFO]   Rate: 1358.2 events/s (physlite_feature_processor.py:1409)
2025-06-27 14:17:50 [    INFO] Preparing histogram data from 5000 sampled events for /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/zprime_bb_dataset_features.png (physlite_feature_processor.py:1442)
2025-06-27 14:17:50 [    INFO] Loaded bin edges metadata from /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:2014)
2025-06-27 14:17:50 [    INFO] Feature 'N_Tracks_per_Event': 0 values (0.0%) below bin range, 38 values (0.8%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Feature 'Track d0': 15 values (0.0%) below bin range, 2 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Feature 'Track z0': 641 values (0.4%) below bin range, 415 values (0.3%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Feature 'Track phi': 116 values (0.1%) below bin range, 139 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Feature 'Track Eta': 35 values (0.0%) below bin range, 48 values (0.0%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Feature 'Track pT': 17 values (0.0%) below bin range, 2759 values (1.9%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Feature 'Track Reduced Chi2': 145 values (0.1%) below bin range, 125 values (0.1%) above bin range. Excluding from histogram to maintain consistent binning. (physlite_feature_processor.py:2049)
2025-06-27 14:17:50 [    INFO] Saved raw histogram data to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/zprime_bb_dataset_features_hist_data.json (physlite_feature_processor.py:1675)
2025-06-27 14:17:50 [    INFO] Saved bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plot_data/background_bin_edges_metadata.json (physlite_feature_processor.py:1993)
2025-06-27 14:17:52 [    INFO] Creating combined input feature distribution comparison plot for background vs. signals. (dataset_manager.py:660)
2025-06-27 14:17:52 [    INFO] Creating plot from 3 data file(s) to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/comparison_input_features_background_vs_signals.png (dataset_visualizer.py:108)
2025-06-27 14:17:56 [    INFO] Successfully created plot and saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/comparison_input_features_background_vs_signals.png (dataset_visualizer.py:283)
2025-06-27 14:17:56 [    INFO] Saved combined comparison plot to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/_processed_datasets/dataset_runs_00298967-2-00311481_912fb71c/plots/comparison_input_features_background_vs_signals.png (dataset_manager.py:690)
2025-06-27 14:17:56 [    INFO] Successfully loaded 2 signal datasets (dataset_manager.py:901)
2025-06-27 14:17:56 [    INFO] Creating balanced labeled datasets... (foundation_model_pipeline.py:1424)
2025-06-27 14:17:58 [    INFO] Total training events available: 66320 (foundation_model_pipeline.py:1454)
2025-06-27 14:17:58 [    INFO] Data sizes to test: [1000, 2000] (foundation_model_pipeline.py:1458)
2025-06-27 14:17:58 [    INFO] Loading foundation model configuration from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:1461)
2025-06-27 14:17:58 [    INFO] Loading pre-trained deterministic encoder from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/deterministic_encoder (foundation_model_pipeline.py:1504)
2025-06-27 14:17:59 [ WARNING] No training configuration found in save file, so the model was *not* compiled. Compile it manually. (load.py:178)
2025-06-27 14:17:59 [    INFO] Loaded deterministic encoder with output shape: (None, 2) (foundation_model_pipeline.py:1511)
2025-06-27 14:17:59 [    INFO]
================================================== (foundation_model_pipeline.py:1611)
2025-06-27 14:17:59 [    INFO] Training with 1000 events (foundation_model_pipeline.py:1612)
2025-06-27 14:17:59 [    INFO] ================================================== (foundation_model_pipeline.py:1613)
2025-06-27 14:17:59 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1619)
2025-06-27 14:17:59 [    INFO] Training From_Scratch model with 1000 events... (foundation_model_pipeline.py:1557)
2025-06-27 14:17:59 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:17:59 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:17:59 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:17:59 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:17:59 [    INFO]   Features: (1000, 180) (model_trainer.py:279)
2025-06-27 14:17:59 [    INFO]   Targets: (1000,) (model_trainer.py:280)
2025-06-27 14:17:59 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:17:59 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:18:01 [    INFO] Epoch 1/3 completed in 2.1s - loss: 6.406672 - binary_accuracy: 0.552000 - precision: 0.000000 - recall: 0.000000 - val_loss: 11.307919 - val_binary_accuracy: 0.134733 - val_precision: 0.906977 - val_recall: 0.002616 (model_trainer.py:36)
2025-06-27 14:18:01 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:18:03 [    INFO] Epoch 2/3 completed in 1.7s - loss: 6.356197 - binary_accuracy: 0.545000 - precision: 0.000000 - recall: 0.000000 - val_loss: 11.198621 - val_binary_accuracy: 0.135053 - val_precision: 0.900990 - val_recall: 0.003052 (model_trainer.py:36)
2025-06-27 14:18:03 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:18:05 [    INFO] Epoch 3/3 completed in 1.6s - loss: 6.149298 - binary_accuracy: 0.558000 - precision: 0.000000 - recall: 0.000000 - val_loss: 11.057129 - val_binary_accuracy: 0.135286 - val_precision: 0.900901 - val_recall: 0.003354 (model_trainer.py:36)
2025-06-27 14:18:05 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:18:05 [    INFO]   loss: 6.149298 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   binary_accuracy: 0.558000 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   precision: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   recall: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   val_loss: 11.057129 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   val_binary_accuracy: 0.135286 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   val_precision: 0.900901 (model_trainer.py:320)
2025-06-27 14:18:05 [    INFO]   val_recall: 0.003354 (model_trainer.py:320)
2025-06-27 14:18:06 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:18:06 [    INFO]   test_loss: 11.056638 (model_trainer.py:409)
2025-06-27 14:18:06 [    INFO]   test_binary_accuracy: 0.135398 (model_trainer.py:409)
2025-06-27 14:18:06 [    INFO]   test_precision: 0.925926 (model_trainer.py:409)
2025-06-27 14:18:06 [    INFO]   test_recall: 0.003354 (model_trainer.py:409)
2025-06-27 14:18:06 [    INFO] From_Scratch with 1000 events - Test Loss: 11.056638, Test Accuracy: 0.135398 (foundation_model_pipeline.py:1593)
2025-06-27 14:18:06 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1652)
2025-06-27 14:18:07 [    INFO] Training Fine_Tuned model with 1000 events... (foundation_model_pipeline.py:1557)
2025-06-27 14:18:07 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:18:07 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:18:07 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:18:07 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:18:07 [    INFO]   Features: (1000, 180) (model_trainer.py:279)
2025-06-27 14:18:07 [    INFO]   Targets: (1000,) (model_trainer.py:280)
2025-06-27 14:18:07 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:18:07 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:18:09 [    INFO] Epoch 1/3 completed in 2.1s - loss: 6.596232 - binary_accuracy: 0.516000 - precision_1: 0.000000 - recall_1: 0.000000 - val_loss: 7.580247 - val_binary_accuracy: 0.379040 - val_precision_1: 0.827368 - val_recall_1: 0.358923 (model_trainer.py:36)
2025-06-27 14:18:09 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:18:11 [    INFO] Epoch 2/3 completed in 1.8s - loss: 5.957386 - binary_accuracy: 0.541000 - precision_1: 0.000000 - recall_1: 0.000000 - val_loss: 7.603683 - val_binary_accuracy: 0.379970 - val_precision_1: 0.829368 - val_recall_1: 0.358956 (model_trainer.py:36)
2025-06-27 14:18:11 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:18:13 [    INFO] Epoch 3/3 completed in 1.8s - loss: 5.804666 - binary_accuracy: 0.556000 - precision_1: 0.000000 - recall_1: 0.000000 - val_loss: 7.648292 - val_binary_accuracy: 0.376334 - val_precision_1: 0.831067 - val_recall_1: 0.352584 (model_trainer.py:36)
2025-06-27 14:18:13 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:18:13 [    INFO]   loss: 5.804666 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   binary_accuracy: 0.556000 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   precision_1: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   recall_1: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   val_loss: 7.648292 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   val_binary_accuracy: 0.376334 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   val_precision_1: 0.831067 (model_trainer.py:320)
2025-06-27 14:18:13 [    INFO]   val_recall_1: 0.352584 (model_trainer.py:320)
2025-06-27 14:18:15 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:18:15 [    INFO]   test_loss: 7.648009 (model_trainer.py:409)
2025-06-27 14:18:15 [    INFO]   test_binary_accuracy: 0.376294 (model_trainer.py:409)
2025-06-27 14:18:15 [    INFO]   test_precision_1: 0.830936 (model_trainer.py:409)
2025-06-27 14:18:15 [    INFO]   test_recall_1: 0.352584 (model_trainer.py:409)
2025-06-27 14:18:15 [    INFO] Fine_Tuned with 1000 events - Test Loss: 7.648009, Test Accuracy: 0.376294 (foundation_model_pipeline.py:1593)
2025-06-27 14:18:15 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1684)
2025-06-27 14:18:15 [    INFO] Training Fixed_Encoder model with 1000 events... (foundation_model_pipeline.py:1557)
2025-06-27 14:18:15 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:18:15 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:18:15 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:18:15 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:18:15 [    INFO]   Features: (1000, 180) (model_trainer.py:279)
2025-06-27 14:18:15 [    INFO]   Targets: (1000,) (model_trainer.py:280)
2025-06-27 14:18:15 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:18:15 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:18:17 [    INFO] Epoch 1/3 completed in 1.8s - loss: 4.334690 - binary_accuracy: 0.681000 - precision_2: 0.000000 - recall_2: 0.000000 - val_loss: 6.955783 - val_binary_accuracy: 0.468687 - val_precision_2: 0.914341 - val_recall_2: 0.427441 (model_trainer.py:36)
2025-06-27 14:18:17 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:18:19 [    INFO] Epoch 2/3 completed in 1.7s - loss: 4.710085 - binary_accuracy: 0.657000 - precision_2: 0.000000 - recall_2: 0.000000 - val_loss: 6.965145 - val_binary_accuracy: 0.468396 - val_precision_2: 0.914280 - val_recall_2: 0.427105 (model_trainer.py:36)
2025-06-27 14:18:19 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:18:21 [    INFO] Epoch 3/3 completed in 1.8s - loss: 4.701032 - binary_accuracy: 0.664000 - precision_2: 0.000000 - recall_2: 0.000000 - val_loss: 6.971789 - val_binary_accuracy: 0.467349 - val_precision_2: 0.914595 - val_recall_2: 0.425596 (model_trainer.py:36)
2025-06-27 14:18:21 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:18:21 [    INFO]   loss: 4.701032 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   binary_accuracy: 0.664000 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   precision_2: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   recall_2: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   val_loss: 6.971789 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   val_binary_accuracy: 0.467349 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   val_precision_2: 0.914595 (model_trainer.py:320)
2025-06-27 14:18:21 [    INFO]   val_recall_2: 0.425596 (model_trainer.py:320)
2025-06-27 14:18:22 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:18:22 [    INFO]   test_loss: 7.001032 (model_trainer.py:409)
2025-06-27 14:18:22 [    INFO]   test_binary_accuracy: 0.465939 (model_trainer.py:409)
2025-06-27 14:18:22 [    INFO]   test_precision_2: 0.911376 (model_trainer.py:409)
2025-06-27 14:18:22 [    INFO]   test_recall_2: 0.425596 (model_trainer.py:409)
2025-06-27 14:18:22 [    INFO] Fixed_Encoder with 1000 events - Test Loss: 7.001032, Test Accuracy: 0.465939 (foundation_model_pipeline.py:1593)
2025-06-27 14:18:22 [    INFO]
================================================== (foundation_model_pipeline.py:1611)
2025-06-27 14:18:22 [    INFO] Training with 2000 events (foundation_model_pipeline.py:1612)
2025-06-27 14:18:22 [    INFO] ================================================== (foundation_model_pipeline.py:1613)
2025-06-27 14:18:22 [    INFO] Building From Scratch model... (foundation_model_pipeline.py:1619)
2025-06-27 14:18:23 [    INFO] Training From_Scratch model with 2000 events... (foundation_model_pipeline.py:1557)
2025-06-27 14:18:23 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:18:23 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:18:23 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:18:23 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:18:23 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:18:23 [    INFO]   Targets: (1024,) (model_trainer.py:280)
2025-06-27 14:18:23 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:18:23 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:18:25 [    INFO] Epoch 1/3 completed in 1.8s - loss: 1.716758 - binary_accuracy: 0.826500 - precision_3: 0.000000 - recall_3: 0.000000 - val_loss: 2.050706 - val_binary_accuracy: 0.209692 - val_precision_3: 0.890068 - val_recall_3: 0.101285 (model_trainer.py:36)
2025-06-27 14:18:25 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:18:27 [    INFO] Epoch 2/3 completed in 1.8s - loss: 1.496397 - binary_accuracy: 0.848000 - precision_3: 0.000000 - recall_3: 0.000000 - val_loss: 2.167875 - val_binary_accuracy: 0.201198 - val_precision_3: 0.891326 - val_recall_3: 0.089949 (model_trainer.py:36)
2025-06-27 14:18:27 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:18:28 [    INFO] Epoch 3/3 completed in 1.7s - loss: 1.474965 - binary_accuracy: 0.851500 - precision_3: 0.000000 - recall_3: 0.000000 - val_loss: 2.259401 - val_binary_accuracy: 0.195875 - val_precision_3: 0.896930 - val_recall_3: 0.082302 (model_trainer.py:36)
2025-06-27 14:18:28 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:18:28 [    INFO]   loss: 1.474965 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   binary_accuracy: 0.851500 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   precision_3: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   recall_3: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   val_loss: 2.259401 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   val_binary_accuracy: 0.195875 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   val_precision_3: 0.896930 (model_trainer.py:320)
2025-06-27 14:18:28 [    INFO]   val_recall_3: 0.082302 (model_trainer.py:320)
2025-06-27 14:18:30 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:18:30 [    INFO]   test_loss: 2.255468 (model_trainer.py:409)
2025-06-27 14:18:30 [    INFO]   test_binary_accuracy: 0.195928 (model_trainer.py:409)
2025-06-27 14:18:30 [    INFO]   test_precision_3: 0.897258 (model_trainer.py:409)
2025-06-27 14:18:30 [    INFO]   test_recall_3: 0.082302 (model_trainer.py:409)
2025-06-27 14:18:30 [    INFO] From_Scratch with 2000 events - Test Loss: 2.255468, Test Accuracy: 0.195928 (foundation_model_pipeline.py:1593)
2025-06-27 14:18:30 [    INFO] Building Fine-Tuned model... (foundation_model_pipeline.py:1652)
2025-06-27 14:18:30 [    INFO] Training Fine_Tuned model with 2000 events... (foundation_model_pipeline.py:1557)
2025-06-27 14:18:30 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:18:30 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:18:30 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:18:30 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:18:30 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:18:30 [    INFO]   Targets: (1024,) (model_trainer.py:280)
2025-06-27 14:18:30 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:18:30 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:18:33 [    INFO] Epoch 1/3 completed in 2.1s - loss: 5.370798 - binary_accuracy: 0.532000 - precision_4: 0.000000 - recall_4: 0.000000 - val_loss: 1.139629 - val_binary_accuracy: 0.413886 - val_precision_4: 0.832542 - val_recall_4: 0.405842 (model_trainer.py:36)
2025-06-27 14:18:33 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:18:35 [    INFO] Epoch 2/3 completed in 2.0s - loss: 5.095107 - binary_accuracy: 0.546000 - precision_4: 0.000000 - recall_4: 0.000000 - val_loss: 1.211506 - val_binary_accuracy: 0.412316 - val_precision_4: 0.834598 - val_recall_4: 0.402086 (model_trainer.py:36)
2025-06-27 14:18:35 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:18:37 [    INFO] Epoch 3/3 completed in 1.9s - loss: 4.815008 - binary_accuracy: 0.549500 - precision_4: 0.000000 - recall_4: 0.000000 - val_loss: 1.243436 - val_binary_accuracy: 0.593182 - val_precision_4: 0.871532 - val_recall_4: 0.622732 (model_trainer.py:36)
2025-06-27 14:18:37 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:18:37 [    INFO]   loss: 4.815008 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   binary_accuracy: 0.549500 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   precision_4: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   recall_4: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   val_loss: 1.243436 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   val_binary_accuracy: 0.593182 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   val_precision_4: 0.871532 (model_trainer.py:320)
2025-06-27 14:18:37 [    INFO]   val_recall_4: 0.622732 (model_trainer.py:320)
2025-06-27 14:18:38 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:18:38 [    INFO]   test_loss: 1.243763 (model_trainer.py:409)
2025-06-27 14:18:38 [    INFO]   test_binary_accuracy: 0.593077 (model_trainer.py:409)
2025-06-27 14:18:38 [    INFO]   test_precision_4: 0.871369 (model_trainer.py:409)
2025-06-27 14:18:38 [    INFO]   test_recall_4: 0.622732 (model_trainer.py:409)
2025-06-27 14:18:38 [    INFO] Fine_Tuned with 2000 events - Test Loss: 1.243763, Test Accuracy: 0.593077 (foundation_model_pipeline.py:1593)
2025-06-27 14:18:38 [    INFO] Building Fixed Encoder model... (foundation_model_pipeline.py:1684)
2025-06-27 14:18:39 [    INFO] Training Fixed_Encoder model with 2000 events... (foundation_model_pipeline.py:1557)
2025-06-27 14:18:39 [    INFO] Starting training with metrics tracking: (model_trainer.py:250)
2025-06-27 14:18:39 [    INFO] Preparing datasets for training... (model_trainer.py:265)
2025-06-27 14:18:39 [    INFO] Training dataset batches: -2 (model_trainer.py:275)
2025-06-27 14:18:39 [    INFO] Training dataset batch shapes: (model_trainer.py:278)
2025-06-27 14:18:39 [    INFO]   Features: (1024, 180) (model_trainer.py:279)
2025-06-27 14:18:39 [    INFO]   Targets: (1024,) (model_trainer.py:280)
2025-06-27 14:18:39 [    INFO] Starting training for 3 epochs (model_trainer.py:27)
2025-06-27 14:18:39 [    INFO] Starting epoch 1/3 (model_trainer.py:31)
2025-06-27 14:18:41 [    INFO] Epoch 1/3 completed in 2.1s - loss: 2.277115 - binary_accuracy: 0.750500 - precision_5: 0.000000 - recall_5: 0.000000 - val_loss: 2.587283 - val_binary_accuracy: 0.185753 - val_precision_5: 0.825714 - val_recall_5: 0.077540 (model_trainer.py:36)
2025-06-27 14:18:41 [    INFO] Starting epoch 2/3 (model_trainer.py:31)
2025-06-27 14:18:43 [    INFO] Epoch 2/3 completed in 2.0s - loss: 2.279570 - binary_accuracy: 0.748500 - precision_5: 0.000000 - recall_5: 0.000000 - val_loss: 2.658395 - val_binary_accuracy: 0.186102 - val_precision_5: 0.827156 - val_recall_5: 0.077841 (model_trainer.py:36)
2025-06-27 14:18:43 [    INFO] Starting epoch 3/3 (model_trainer.py:31)
2025-06-27 14:18:45 [    INFO] Epoch 3/3 completed in 2.2s - loss: 2.268842 - binary_accuracy: 0.751000 - precision_5: 0.000000 - recall_5: 0.000000 - val_loss: 2.786879 - val_binary_accuracy: 0.185346 - val_precision_5: 0.826009 - val_recall_5: 0.076902 (model_trainer.py:36)
2025-06-27 14:18:45 [    INFO] Training completed. Final metrics: (model_trainer.py:318)
2025-06-27 14:18:45 [    INFO]   loss: 2.268842 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   binary_accuracy: 0.751000 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   precision_5: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   recall_5: 0.000000 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   val_loss: 2.786879 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   val_binary_accuracy: 0.185346 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   val_precision_5: 0.826009 (model_trainer.py:320)
2025-06-27 14:18:45 [    INFO]   val_recall_5: 0.076902 (model_trainer.py:320)
2025-06-27 14:18:47 [    INFO] Evaluation metrics: (model_trainer.py:407)
2025-06-27 14:18:47 [    INFO]   test_loss: 2.782796 (model_trainer.py:409)
2025-06-27 14:18:47 [    INFO]   test_binary_accuracy: 0.187202 (model_trainer.py:409)
2025-06-27 14:18:47 [    INFO]   test_precision_5: 0.845190 (model_trainer.py:409)
2025-06-27 14:18:47 [    INFO]   test_recall_5: 0.076902 (model_trainer.py:409)
2025-06-27 14:18:47 [    INFO] Fixed_Encoder with 2000 events - Test Loss: 2.782796, Test Accuracy: 0.187202 (foundation_model_pipeline.py:1593)
2025-06-27 14:18:47 [    INFO] Creating data efficiency plots... (foundation_model_pipeline.py:1716)
2025-06-27 14:18:47 [    INFO] Results saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/signal_classification/signal_classification_data_efficiency_results.json (foundation_model_pipeline.py:1722)
2025-06-27 14:18:49 [    INFO] Loss plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/signal_classification/signal_classification_loss_plot.png (foundation_model_pipeline.py:1830)
2025-06-27 14:18:49 [    INFO] Accuracy plot saved to: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/signal_classification/signal_classification_accuracy_plot.png (foundation_model_pipeline.py:1831)
2025-06-27 14:18:49 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1837)
2025-06-27 14:18:49 [    INFO] Signal Classification Evaluation Results Summary (foundation_model_pipeline.py:1838)
2025-06-27 14:18:49 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:1839)
2025-06-27 14:18:49 [    INFO] Signal Dataset: zprime_tt (foundation_model_pipeline.py:1840)
2025-06-27 14:18:49 [    INFO] Training Events: 1000 (foundation_model_pipeline.py:1843)
2025-06-27 14:18:49 [    INFO]   From Scratch:  Loss: 11.056638, Accuracy: 0.135398 (foundation_model_pipeline.py:1844)
2025-06-27 14:18:49 [    INFO]   Fine-Tuned:    Loss: 7.648009, Accuracy: 0.376294 (foundation_model_pipeline.py:1845)
2025-06-27 14:18:49 [    INFO]   Fixed Encoder: Loss: 7.001032, Accuracy: 0.465939 (foundation_model_pipeline.py:1846)
2025-06-27 14:18:49 [    INFO]   Fine-Tuned accuracy improvement: 27.9% (foundation_model_pipeline.py:1853)
2025-06-27 14:18:49 [    INFO]   Fixed accuracy improvement: 38.2% (foundation_model_pipeline.py:1854)
2025-06-27 14:18:49 [    INFO]  (foundation_model_pipeline.py:1855)
2025-06-27 14:18:49 [    INFO] Training Events: 2000 (foundation_model_pipeline.py:1843)
2025-06-27 14:18:49 [    INFO]   From Scratch:  Loss: 2.255468, Accuracy: 0.195928 (foundation_model_pipeline.py:1844)
2025-06-27 14:18:49 [    INFO]   Fine-Tuned:    Loss: 1.243763, Accuracy: 0.593077 (foundation_model_pipeline.py:1845)
2025-06-27 14:18:49 [    INFO]   Fixed Encoder: Loss: 2.782796, Accuracy: 0.187202 (foundation_model_pipeline.py:1846)
2025-06-27 14:18:49 [    INFO]   Fine-Tuned accuracy improvement: 49.4% (foundation_model_pipeline.py:1853)
2025-06-27 14:18:49 [    INFO]   Fixed accuracy improvement: -1.1% (foundation_model_pipeline.py:1854)
2025-06-27 14:18:49 [    INFO]  (foundation_model_pipeline.py:1855)
2025-06-27 14:18:49 [    INFO] Signal classification evaluation completed successfully (foundation_model_pipeline.py:1857)
2025-06-27 14:18:49 [    INFO] Signal classification evaluation completed successfully (foundation_model_pipeline.py:293)
2025-06-27 14:18:49 [    INFO]
================================================== (foundation_model_pipeline.py:296)
2025-06-27 14:18:49 [    INFO] STEP 4/4: ANOMALY DETECTION EVALUATION (foundation_model_pipeline.py:297)
2025-06-27 14:18:49 [    INFO] ================================================== (foundation_model_pipeline.py:298)
2025-06-27 14:18:49 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:649)
2025-06-27 14:18:49 [    INFO] Evaluating Foundation Model for Anomaly Detection (foundation_model_pipeline.py:650)
2025-06-27 14:18:49 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:651)
2025-06-27 14:18:49 [    INFO] ModelRegistry paths: (model_registry.py:27)
2025-06-27 14:18:49 [    INFO] Base path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments (model_registry.py:28)
2025-06-27 14:18:49 [    INFO] DB path: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (model_registry.py:29)
2025-06-27 14:18:50 [    INFO] Registry initialized at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/registry.db (foundation_model_pipeline.py:683)
2025-06-27 14:18:50 [    INFO] Loading original model config from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/_experiment_config.yaml (foundation_model_pipeline.py:686)
2025-06-27 14:18:50 [    INFO] Initializing Dataset Manager... (foundation_model_pipeline.py:715)
2025-06-27 14:18:50 [    INFO] Loaded custom plot label map from src/hep_foundation/data/plot_labels.json (physlite_feature_processor.py:72)
2025-06-27 14:18:50 [    INFO] Using batch size from provided VAE training config: 1024 (foundation_model_pipeline.py:723)
2025-06-27 14:18:50 [    INFO] Loading background (test) dataset... (foundation_model_pipeline.py:734)
2025-06-27 14:18:50 [    INFO] Loading datasets (dataset_manager.py:769)
2025-06-27 14:18:50 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:18:51 [    INFO] Loaded background (test) dataset. (foundation_model_pipeline.py:745)
2025-06-27 14:18:51 [    INFO] Reloading signal datasets for evaluation and comparison plotting... (foundation_model_pipeline.py:776)
2025-06-27 14:18:51 [    INFO] Loading signal datasets (dataset_manager.py:850)
2025-06-27 14:18:51 [    INFO] Generated dataset ID: dataset_runs_00298967-2-00311481_912fb71c (dataset_manager.py:115)
2025-06-27 14:18:52 [    INFO] Successfully loaded 2 signal datasets (dataset_manager.py:901)
2025-06-27 14:18:52 [    INFO] Reloaded 2 signal datasets for evaluation. (foundation_model_pipeline.py:785)
2025-06-27 14:18:52 [    INFO] Instantiating VAE model from loaded configuration... (foundation_model_pipeline.py:795)
2025-06-27 14:18:52 [ WARNING] Input shape missing in loaded model config, deriving from task_config. (foundation_model_pipeline.py:799)
2025-06-27 14:18:52 [    INFO] Built encoder layers (variational_autoencoder.py:283)
2025-06-27 14:18:52 [    INFO] Built encoder model (variational_autoencoder.py:310)
2025-06-27 14:18:52 [    INFO] Built deterministic encoder model (variational_autoencoder.py:316)
2025-06-27 14:18:52 [    INFO] Built decoder layers (variational_autoencoder.py:341)
2025-06-27 14:18:52 [    INFO] Built decoder model (variational_autoencoder.py:358)
2025-06-27 14:18:53 [    INFO] Completed VAE architecture build (variational_autoencoder.py:369)
2025-06-27 14:18:53 [    INFO] Loading model weights from: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/models/foundation_model/full_model (foundation_model_pipeline.py:836)
2025-06-27 14:18:53 [    INFO] VAE model loaded successfully. (foundation_model_pipeline.py:839)
2025-06-27 14:18:53 [    INFO] None (foundation_model_pipeline.py:840)
2025-06-27 14:18:53 [    INFO] Running anomaly detection evaluation... (foundation_model_pipeline.py:846)
2025-06-27 14:18:53 [    INFO] Running anomaly detection test... (variational_autoencoder.py:1139)
2025-06-27 14:18:53 [    INFO] Dataset information before testing: (variational_autoencoder.py:1149)
2025-06-27 14:18:53 [    INFO] Background test dataset batch shape: (1024, 180) (variational_autoencoder.py:1157)
2025-06-27 14:18:53 [    INFO] zprime_bb signal dataset batch shape: (1024, 180) (variational_autoencoder.py:1168)
2025-06-27 14:18:53 [    INFO] zprime_tt signal dataset batch shape: (1024, 180) (variational_autoencoder.py:1168)
2025-06-27 14:18:53 [    INFO] Calculating losses for background dataset... (variational_autoencoder.py:1174)
2025-06-27 14:18:53 [    INFO] Calculating losses for dataset... (variational_autoencoder.py:668)
2025-06-27 14:18:55 [    INFO] Dataset stats: (variational_autoencoder.py:716)
2025-06-27 14:18:55 [    INFO]   Total batches: 45 (variational_autoencoder.py:717)
2025-06-27 14:18:55 [    INFO]   Total events: 45628 (variational_autoencoder.py:718)
2025-06-27 14:18:55 [    INFO]   Events per batch: 1014.0 (variational_autoencoder.py:719)
2025-06-27 14:18:55 [    INFO] Calculating losses for signal dataset: zprime_bb (variational_autoencoder.py:1182)
2025-06-27 14:18:55 [    INFO] Calculating losses for dataset... (variational_autoencoder.py:668)
2025-06-27 14:18:56 [    INFO] Dataset stats: (variational_autoencoder.py:716)
2025-06-27 14:18:56 [    INFO]   Total batches: 10 (variational_autoencoder.py:717)
2025-06-27 14:18:56 [    INFO]   Total events: 9752 (variational_autoencoder.py:718)
2025-06-27 14:18:56 [    INFO]   Events per batch: 975.2 (variational_autoencoder.py:719)
2025-06-27 14:18:56 [    INFO] Calculating losses for signal dataset: zprime_tt (variational_autoencoder.py:1182)
2025-06-27 14:18:56 [    INFO] Calculating losses for dataset... (variational_autoencoder.py:668)
2025-06-27 14:18:57 [    INFO] Dataset stats: (variational_autoencoder.py:716)
2025-06-27 14:18:57 [    INFO]   Total batches: 30 (variational_autoencoder.py:717)
2025-06-27 14:18:57 [    INFO]   Total events: 29817 (variational_autoencoder.py:718)
2025-06-27 14:18:57 [    INFO]   Events per batch: 993.9 (variational_autoencoder.py:719)
2025-06-27 14:18:57 [    INFO] Creating combined loss distribution plots... (variational_autoencoder.py:945)
2025-06-27 14:18:57 [    INFO] Calculating global bin edges for coordinated loss distribution binning... (variational_autoencoder.py:954)
2025-06-27 14:18:57 [    INFO] Reconstruction loss bin range: [48.781, 3495.927] (covers 99.8% of all data) (variational_autoencoder.py:983)
2025-06-27 14:18:57 [    INFO] KL divergence loss bin range: [0.099, 3.980] (covers 99.8% of all data) (variational_autoencoder.py:986)
2025-06-27 14:18:57 [    INFO] Using coordinated bin edges to ensure perfect histogram alignment (variational_autoencoder.py:989)
2025-06-27 14:18:57 [    INFO] Saved loss bin edges metadata to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_bin_edges_metadata.json (variational_autoencoder.py:1016)
2025-06-27 14:18:57 [    INFO] Saved reconstruction loss distribution data for background to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_background_reconstruction_data.json (variational_autoencoder.py:857)
2025-06-27 14:18:57 [    INFO] Saved kl_divergence loss distribution data for background to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_background_kl_divergence_data.json (variational_autoencoder.py:857)
2025-06-27 14:18:57 [    INFO] Saved reconstruction loss distribution data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_bb_reconstruction_data.json (variational_autoencoder.py:857)
2025-06-27 14:18:57 [    INFO] Saved kl_divergence loss distribution data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_bb_kl_divergence_data.json (variational_autoencoder.py:857)
2025-06-27 14:18:58 [    INFO] Saved reconstruction ROC curve data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_bb_reconstruction_data.json (variational_autoencoder.py:924)
2025-06-27 14:18:58 [    INFO] Saved kl_divergence ROC curve data for zprime_bb to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_bb_kl_divergence_data.json (variational_autoencoder.py:924)
2025-06-27 14:18:58 [    INFO] Saved reconstruction loss distribution data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_tt_reconstruction_data.json (variational_autoencoder.py:857)
2025-06-27 14:18:58 [    INFO] Saved kl_divergence loss distribution data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/loss_distributions_zprime_tt_kl_divergence_data.json (variational_autoencoder.py:857)
2025-06-27 14:18:58 [    INFO] Saved reconstruction ROC curve data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_tt_reconstruction_data.json (variational_autoencoder.py:924)
2025-06-27 14:18:58 [    INFO] Saved kl_divergence ROC curve data for zprime_tt to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plot_data/roc_curves_zprime_tt_kl_divergence_data.json (variational_autoencoder.py:924)
2025-06-27 14:18:58 [    INFO] Creating combined two-panel loss distribution plot from 3 dataset(s) to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_loss_distributions.png (dataset_visualizer.py:404)
2025-06-27 14:18:59 [    INFO] Successfully created combined two-panel loss distribution plot and saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_loss_distributions.png (dataset_visualizer.py:505)
2025-06-27 14:18:59 [    INFO] Saved combined two-panel loss distribution plot to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_loss_distributions.png (variational_autoencoder.py:1091)
2025-06-27 14:18:59 [    INFO] Creating combined two-panel ROC curves plot from 2 dataset(s) to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_roc_curves.png (dataset_visualizer.py:633)
2025-06-27 14:19:00 [    INFO] Successfully created combined two-panel ROC curves plot and saved to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_roc_curves.png (dataset_visualizer.py:721)
2025-06-27 14:19:00 [    INFO] Saved combined ROC curves plot to /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model/testing/anomaly_detection/plots/combined_roc_curves.png (variational_autoencoder.py:1118)
2025-06-27 14:19:00 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:861)
2025-06-27 14:19:00 [    INFO] Anomaly Detection Results (foundation_model_pipeline.py:862)
2025-06-27 14:19:00 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:863)
2025-06-27 14:19:00 [    INFO] Foundation Model ID: 001_Foundation_VAE_Model (foundation_model_pipeline.py:865)
2025-06-27 14:19:00 [    INFO] Anomaly detection evaluation completed. Results are available in the testing directory. (foundation_model_pipeline.py:866)
2025-06-27 14:19:00 [    INFO] Anomaly detection evaluation completed successfully (foundation_model_pipeline.py:870)
2025-06-27 14:19:00 [    INFO] Anomaly detection evaluation completed successfully (foundation_model_pipeline.py:313)
2025-06-27 14:19:00 [    INFO]
==================================================================================================== (foundation_model_pipeline.py:316)
2025-06-27 14:19:00 [    INFO] FULL PIPELINE COMPLETED SUCCESSFULLY (foundation_model_pipeline.py:317)
2025-06-27 14:19:00 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:318)
2025-06-27 14:19:00 [    INFO] Foundation model: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (foundation_model_pipeline.py:319)
2025-06-27 14:19:00 [    INFO] All four processes (train → regression → signal classification → anomaly) completed successfully (foundation_model_pipeline.py:320)
2025-06-27 14:19:00 [    INFO] ==================================================================================================== (foundation_model_pipeline.py:323)
2025-06-27 14:19:00 [    INFO] Full pipeline test completed successfully. Model saved at: /fs/ddn/sdf/group/atlas/d/alexyue/hep_foundation/_test_results/test_foundation_experiments/001_Foundation_VAE_Model (test_pipeline.py:208)
PASSED                                                                   [100%]

=============================== warnings summary ===============================
../../../../../../../../sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:65
  /sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:65: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if (distutils.version.LooseVersion(tf.version.VERSION) <

../../../../../../../../sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:66
  /sdf/home/a/alexyue/miniconda3/envs/hep_foundation/lib/python3.9/site-packages/tensorflow_model_optimization/__init__.py:66: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    distutils.version.LooseVersion(required_tensorflow_version)):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================== 1 passed, 2 warnings in 251.80s (0:04:11) ===================
